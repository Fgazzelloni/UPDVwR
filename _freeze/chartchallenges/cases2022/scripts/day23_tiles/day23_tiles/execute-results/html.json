{
  "hash": "7881106e3e254f6084e47bdf272bf615",
  "result": {
    "markdown": "---\ntitle: \"Untitled\"\noutput: html_document\n---\n\n\n\n\nSource: \n\n- https://ourworldindata.org/financing-education\n- \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nedu_exp <- read_csv(\"total-government-expenditure-on-education-gdp.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 4849 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (2): Year, Government expenditure on education, total (% of GDP)\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n  edu_exp1 <- edu_exp%>%\n  janitor::clean_names()%>%\n  rename(value=government_expenditure_on_education_total_percent_of_gdp)\n\nedu_exp2 <- complete(edu_exp1, entity,year,fill=list(value=0))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nworld<- map_data(\"world\")\nregions<- plyr::count(world$region)%>%select(-freq)%>%unlist()\n\nedu_exp3 <- edu_exp2%>%\n  filter(entity%in%regions)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_countries <- edu_exp3%>%\n  filter(!entity==\"Zimbabwe\")%>%\n  mutate(year2=cut(year,4))%>%\n  group_by(entity)%>%\n  summarize(tot=sum(value))%>%\n  ungroup()%>%\n  arrange(-tot)%>%\n  slice(1:50)%>%\n  unlist()\n\n\nedu_exp4 <- edu_exp3%>%\n  filter(entity%in%my_countries)%>%\n  mutate(entity=as.factor(entity),\n         year2=cut(year,4))%>%\n  group_by(entity,year2)%>%  #2500\n  mutate(value2=(value-mean(value))/(sd(value)/sqrt(2500)))%>%\n  ungroup()\n\n\nedu_exp4%>%summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       entity          year          code               value       \n Argentina:  50   Min.   :1970   Length:2500        Min.   : 0.000  \n Australia:  50   1st Qu.:1982   Class :character   1st Qu.: 0.000  \n Austria  :  50   Median :1994   Mode  :character   Median : 4.127  \n Belgium  :  50   Mean   :1994                      Mean   : 3.332  \n Botswana :  50   3rd Qu.:2007                      3rd Qu.: 5.435  \n Canada   :  50   Max.   :2019                      Max.   :14.059  \n (Other)  :2200                                                     \n                 year2         value2       \n (1.97e+03,1.98e+03]:650   Min.   :-162.55  \n (1.98e+03,1.99e+03]:600   1st Qu.: -27.64  \n (1.99e+03,2.01e+03]:600   Median :  12.02  \n (2.01e+03,2.02e+03]:650   Mean   :   0.00  \n                           3rd Qu.:  30.66  \n                           Max.   : 166.41  \n                           NA's   :116      \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'plotly'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n:::\n\n```{.r .cell-code}\nlibrary(hrbrthemes)\nlibrary(extrafont)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistering fonts with R\n```\n:::\n\n```{.r .cell-code}\n# loadfonts()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nedu_exp4%>%count(entity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 50 × 2\n   entity         n\n   <fct>      <int>\n 1 Argentina     50\n 2 Australia     50\n 3 Austria       50\n 4 Belgium       50\n 5 Botswana      50\n 6 Canada        50\n 7 Chile         50\n 8 Costa Rica    50\n 9 Cuba          50\n10 Cyprus        50\n# ℹ 40 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\np <- ggplot(edu_exp4, aes(x=year, y=fct_reorder(entity,value))) +\n  geom_tile(aes(fill = value),color=\"black\") +\n  geom_vline(aes(xintercept=c(1969.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(1979.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(1989.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(1999.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(2009.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(2019.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  scale_fill_gradient(low=\"white\",high=\"blue\",\n                      breaks=c(1.5,12),\n                      labels=c(\"Min\",\"Max\")) +\n  guides(fill = guide_colourbar(barwidth = 9, \n                                barheight = 2,title.position = \"top\",\n                                label = F,\n                                ticks = FALSE))+\n  scale_x_continuous(expand=c(0,0),\n                     breaks=seq(1970,2019,10),\n                     label=c(\"1970-1979\",\"1980-1989\",\"1990-1999\",\"2000-2009\",\"2010-2019\"))+\n  labs(title = \"Government expenditure on education\", subtitle=\"Selected countries with on average total (% of GDP) between 3 and 9%\",\n       caption=\"#30DayChartChallenge 2022 #Day23 -Tiles\n       DataSource: UNESCO Institute for Statistics via OurWorldInData\\n \n       DataViz: Federica Gazzelloni\",\n       x=\"\",y=\"\",fill=\"AVG tot GDP %\")+\n    theme_ipsum()+\n  theme(text=element_text(size=12,face=\"bold\",\n                          family=\"Roboto Condensed\"),\n        axis.text.x = element_text(size=16,vjust=0.5,hjust=-0.5),\n        axis.text.y = element_text(size=15),\n        plot.title = element_text(size=42,\n                                  family=\"Roboto Condensed\"),\n        plot.subtitle = element_text(family=\"Roboto Condensed\",size=18,face=\"bold\"),\n        plot.caption = element_text(family=\"Roboto Condensed\",size=15,hjust=1,face=\"bold\"),\n        plot.title.position = \"panel\",\n        plot.background = element_rect(color=\"grey80\",fill=\"grey80\"),\n        panel.background = element_rect(color=\"grey80\",fill=\"grey80\"),\n        legend.title = element_text(size=18,vjust=1,color=\"grey30\"),\n        legend.text = element_text(size=18,color=\"grey30\"),\n        legend.position = c(0,-0.09),\n        legend.direction = \"horizontal\",\n        plot.margin = margin(10,10,10,1,unit = \"pt\"))+\n  annotate(\"text\",x=1975,y=-4,label=\"How to read it:\\n- white means 0/empty-value\\n- color gradient range on avg between 3 and 9%\\n- avg calculated from 1970 to 2019\",hjust = 0)+\n  coord_cartesian(ylim=c(1,50),clip=\"off\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n```{.r .cell-code}\np\n```\n\n::: {.cell-output-display}\n![](day23_tiles_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ggplotly(p)\nggsave(\"day23_tiles.png\",\n       dpi=320,\n       width = 12,\n       height = 14)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "day23_tiles_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}