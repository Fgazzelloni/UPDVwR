{
  "hash": "59044428d875e3d300cfbfdafd86feb7",
  "result": {
    "markdown": "---\ntitle: '3-dimensional'\nsubtitle: 'Welcome to #30DayChartChallenge 2022 day 14'\ndate: '2022-04-14'\nimage: 'day14_3-dimensional.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\nEmployed scientists and engineers, by sex and occupation: 2019\n\n::: {.cell}\n\n```{.r .cell-code}\nscientists <- readxl::read_excel(\"~/Documents/R/WomenInSTEM/nsb20212-tabslbr-024_scientists.xlsx\",\n                                 na = \"0\", skip = 3)\n# View(scientists)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nscientists1 <- scientists[-1,]%>%\n  janitor::clean_names() %>%#names\n  rename(female_perc=x4,male_perc=x6) %>%\n  mutate(female=ifelse(female==\"s\",0,female),\n         female_perc=ifelse(female_perc==\"s\",0,female_perc),\n         male=ifelse(male==\"s\",0,male),\n         male_perc=ifelse(male_perc==\"s\",0,male_perc),\n         total=ifelse(total==\"s\",0,total)) %>%\n  mutate(across(-occupation,as.numeric)) %>% \n  filter(!occupation%in%c(\"All occupations\")) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf<- scientists1%>%\n  select(female,male,total) %>%\n  filter(female>0,male>0,total>0)%>%\n  log10()\n\n\ncol_df <-scientists1 %>%\n  pivot_longer(cols = c(total,female,male),names_to=\"names\",values_to=\"values\")%>%\n  distinct()\n# Add a new column with color\nmycolors <- c('royalblue1', 'darkcyan', 'oldlace')\n#scientists1$color <- mycolors\n\nlibrary(rgl)\nplot3d( \n  x=df$female, \n  y=df$male, \n  z=df$total, \n  col = mycolors,\n  aspect=0.5,\n  lwd=2,\n  type = 'h', \n  radius = .1,\n  xlab=\"Female\", ylab=\"Male\", zlab=\"Total\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rayshader)\n\nplot<-scientists1%>%\n   filter(female>0,female_perc>0.00001,total>0) %>%\n  ggplot() + \n  geom_jitter(aes(x=total, y=female, color=log10(total))) + \n  scale_x_log10()+\n  scale_y_log10()+\n  scale_color_continuous(limits = c(0, 8))\n\n \n\nplot_gg(plot, \n        #width = 3.5, \n        multicore = TRUE,\n        windowsize = c(800, 800))\n        \n# zoom = (0.85, phi = 35, \n#         theta = 30, sunangle = 225, \n#         soliddepth = -100)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngg = scientists1%>%\n   filter(female>0,male>0.00001,total>0) %>%\n  pivot_longer(cols = c(female,male),names_to=\"gender\",values_to=\"values\") %>%\n  ggplot(aes(x=total, y=values)) +\n  stat_density_2d(aes(fill = stat(nlevel)), \n                  geom = \"polygon\",\n                  n = 100,bins = 10,contour = TRUE) +\n  facet_wrap(gender~.) +\n  scale_fill_viridis_c(option = \"A\")\nplot_gg(gg,multicore=TRUE,width=5,height=5,scale=250)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nemployed <- readxl::read_excel(here::here(\"WomenInStem/nsb20212-tabslbr-025_employed.xlsx\"), \n                               na = \"0\", \n                               skip = 3)\n# View(employed)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nemployed1 <- employed[-1,] %>%\n  janitor::clean_names()%>%#names\n  rename(female_perc=x4,male_perc=x6,education=field_of_s_e_highest_degree) %>%\n  mutate(female=ifelse(female==\"s\",0,female),\n         female_perc=ifelse(female_perc==\"s\",0,female_perc),\n         male=ifelse(male==\"s\",0,male),\n         male_perc=ifelse(male_perc==\"s\",0,male_perc),\n         total=ifelse(total==\"s\",0,total)) %>%\n  mutate(across(-education,as.numeric)) %>%\n  arrange(education) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngg1 <-employed1 %>%\n  pivot_longer(cols = c(female,male),names_to=\"gender\",values_to=\"values\") %>%\n  ggplot(aes(x=total, y=values)) +\n  stat_density_2d(aes(fill = stat(nlevel)), \n                  geom = \"polygon\",\n                  n = 100,bins = 10,contour = TRUE) +\n  facet_wrap(gender~.) +\n  scale_fill_viridis_c(option = \"B\") +\n  labs(title=\"STEM education by gender\",\n       caption=\"Dataviz: Federica Gazzelloni\")+\n  ggthemes::theme_economist_white()+\n  theme(legend.position =c(0.2,-0.05),\n        legend.direction = \"horizontal\")\nlibrary(rayshader)\nplot_gg(gg1,\n        multicore=TRUE,\n        #invert=TRUE,\n        width=5,height=5,\n        scale=250)\nSys.sleep(0.2)\n\nrender_snapshot(clear = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntempfilehdr = tempfile(fileext = \".hdr\")\ndownload.file(\"https://www.tylermw.com/data/venice_sunset_2k.hdr\",tempfilehdr)\nplot_gg(gg1, \n        width = 5, height = 5, \n        scale = 250, \n        multicore = TRUE, \n        windowsize = c(1200, 960))\n        \n\n\n\nSys.sleep(0.2)\n# render_depth(focallength = 100,clear=TRUE)\n\nrender_highquality(samples = 256, \n                   aperture=30, \n                   light = FALSE, \n                   focal_distance = 1700,\n                   obj_material = rayrender::dielectric(attenuation = c(1,1,0.3)/200), \n                   ground_material = rayrender::diffuse(checkercolor = \"grey80\",\n                                                        sigma=90,\n                                                        checkerperiod = 100),\n                   environment_light = tempfilehdr, \n                   camera_lookat = c(0,-150,0))\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}