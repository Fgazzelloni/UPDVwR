{
  "hash": "c919d3af94bec34904be8280a85ce713",
  "result": {
    "markdown": "---\ntitle: 'Theme day'\nsubtitle: 'Welcome to #30DayChartChallenge 2022 day 24'\ndate: '2022-04-24'\nimage: 'day24_theme_day.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\n\n\n\n### sources: https://raw.githubusercontent.com/johnburnmurdoch/johnburnmurdoch.github.io/master/slides/r-ggplot/r-scripts.R?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nedu_exp <- read_csv(\"total-government-expenditure-on-education-gdp.csv\")\n\nedu_exp1 <- edu_exp%>%\n  janitor::clean_names()%>%\n  rename(value=government_expenditure_on_education_total_percent_of_gdp)\n\nedu_exp2 <- complete(edu_exp1, entity,year,fill=list(value=0))\n\noptions(scipen = 999)\n\n\n# edu_exp2_ft <- edu_exp2%>%\n#   mutate(year2=cut(year,4))%>%\n#   group_by(entity,year2)%>%\n#   summarize(tot=sum(value))%>%\n#   ungroup()%>%\n#   arrange(year2)\n\n# remotes::install_github(\"Financial-Times/ftplottools\")\n# library(ftplottools)\n\n# source('~/Documents/R/R_general_resources/EDA/ft_theme/ft_colors.R')\n# source('~/Documents/R/R_general_resources/EDA/ft_theme/ft_theme.R')\n\nedu_exp2_ft<- edu_exp2%>%\n  filter(value>0)\n\nclass<- rev(c(\"World\",\"High income\",\n          \"Middle income\",\n          \"Upper middle income\",\n          \"Low & middle income\",\n          \"Lower middle income\",\n          \"Low income\"))\n\nlevels(class)<-class\n\n# colors<-ft_o_colors[7:13]\n#names(colors)<- class\n\n\n\nedu_exp2_ft2 <- edu_exp2_ft%>%\n  filter(entity%in%class)%>%\n  filter(year>1998 & year<=2017)\n\nwld_y<- edu_exp2_ft2%>%filter(entity==\"High income\")%>%select(value)%>%unlist()\nwld_x<-edu_exp2_ft2%>%filter(entity==\"High income\")%>%select(year)%>%unlist()  \n\n\nlibrary(extrafont)\nlibrary(showtext)\nsysfonts::font_add_google(\"Zen Antique Soft\",\"zas\")\n\nshowtext.auto(enable = T)\nshowtext_opts(dpi = 320)\n\nlibrary(geomtextpath)\n\nedu_exp2_ft2%>%summary\n\np <-ggplot(data= edu_exp2_ft2%>%filter(entity==\"World\"),\n       aes(x=factor(year),y=(value),color=entity,\n             group=factor(entity),label=entity))+\n  #geom_line(size=1,key_glyph = \"timeseries\")+\n  geom_textline(size=6,key_glyph = \"timeseries\",\n                fontface=\"bold\",#hjust=0,\n                linewidth = 2,\n                show.legend = F)+\n  geom_line(data= edu_exp2_ft2%>%filter(!entity==\"World\"),\n                size=0.5,key_glyph = \"timeseries\",show.legend = T) +\n  geom_line(data= edu_exp2_ft2%>%filter(entity==\"High income\"),\n            size=1,key_glyph = \"timeseries\",show.legend = T) +\n  #geom_point(size=2,show.legend = F)+\n  geom_segment(aes(yend=0,xend=factor(year)),\n               size=4,alpha=0.1,\n               inherit.aes = T,show.legend = F) +\n  geom_segment(aes(yend=wld_y,xend=factor(wld_x)),\n               size=4,alpha=0.4,\n               inherit.aes = T,show.legend = F)+\n  geom_segment(aes(y= 7, yend=8,\n                   x=19, xend=19),\n               size=10,alpha=0.4,\n               inherit.aes = T,show.legend = F)+\n  geom_segment(aes(y= 5.8, yend=6.3,\n                   x=16.8, xend=16.8),\n               size=40,\n               inherit.aes = T,show.legend = F)+\n  scale_y_log10()+\n  scale_x_discrete(expand = c(0,0.5),breaks=seq(1999,2017,3)) +\n  scale_color_manual(breaks=class,\n                     values=scales::brewer_pal('qual',2)(7))+\n  guides(colour = guide_legend(nrow = 2))+\n  coord_cartesian(clip = \"off\",ylim = c(2.646,5.370))+\n  labs(title=\"The Gap between High-income countries and the World AVG\",\n       subtitle=\"on Government expenditure on education total(% GDP)\",\n       color=\"\",\n       x=\"Time (Year)\",y=\"Total (% of GDP)\",\n       caption=\"\\n#30DayChartChallenge 2022 #Day24 - theme day: Fiancial Times\\nDataSource: UNESCO Institute for Statistics via OurWorldInData\\n \n       DataViz: Federica Gazzelloni |Twitter: @fgazzelloni\")+\n  ftplottools::ft_theme(base_size=16,\n                        legend_right=F)+\n  theme(text = element_text(family=\"zas\"),\n        axis.text.x = element_text(size=12),\n        plot.title = element_text(size=18),\n        plot.subtitle = element_text(size=12),\n        plot.caption = element_text(vjust=0.5,hjust=1,size=11),\n        plot.background = element_rect(fill=\"#fff1e0\",color=\"#fff1e0\"),\n        panel.background = element_rect(fill=\"#fff1e0\",color=\"#fff1e0\"),\n        legend.box.background = element_blank(),\n        legend.text = element_text(size=12,hjust=-0.02))\n\nlibrary(cowplot)\n\nggdraw(p)+\n  draw_label(\"Financial Times\", fontfamily = \"zas\",\n             x=0.15,y=0.08)\n\nggsave(\"test_ft5.png\",\n       dpi=320,\n      height = 6.22 , \n      width =  8.51)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}