{
  "hash": "d800b94fe10adeaeff7f7e5be810874e",
  "result": {
    "markdown": "---\ntitle: \"TidyTuesday 2023 w2 Bird FeederWatch data\"\nauthor: \"Federica Gazzelloni\"\nexecute:  \n  comments: \"\"\n  eval: true\n  echo: true\n  warning: false\n  message: false\n---\n\n\nResources: \n\n- [https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-01-10](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-01-10)\n- [https://feederwatch.org/explore/raw-dataset-requests/](https://feederwatch.org/explore/raw-dataset-requests/)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ntuesdata <- tidytuesdayR::tt_load(2023, week = 02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 2: `PFW_2021_public.csv`\n\tDownloading file 2 of 2: `PFW_count_site_data_public_2021.csv`\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntuesdata$PFW_2021_public%>%head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 22\n  loc_id    latitude longitude subnational1_code entry_technique   sub_id obs_id\n  <chr>        <dbl>     <dbl> <chr>             <chr>             <chr>  <chr> \n1 L981010       52.1    -122.  CA-BC             POSTCODE LAT/LON… S8320… OBS10…\n2 L3161698      43.8    -123.  US-OR             /GOOGLE_MAP/ZOOM… S7803… OBS10…\n3 L13210778     39.7     -75.9 US-MD             /GOOGLE_MAP/ZOOM… S8131… OBS10…\n4 L13258348     42.2     -83.7 US-MI             /GOOGLE_MAP/ZOOM… S7925… OBS10…\n5 L149639       32.7     -79.9 US-SC             PointMaker1.0_2   S7918… OBS10…\n6 L10140349     46.1     -73.1 CA-QC             /GOOGLE_MAP/ZOOM… S8344… OBS10…\n# ℹ 15 more variables: Month <dbl>, Day <dbl>, Year <dbl>,\n#   PROJ_PERIOD_ID <chr>, species_code <chr>, how_many <dbl>, valid <dbl>,\n#   reviewed <dbl>, day1_am <dbl>, day1_pm <dbl>, day2_am <dbl>, day2_pm <dbl>,\n#   effort_hrs_atleast <dbl>, snow_dep_atleast <dbl>, Data_Entry_Method <chr>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntuesdata$PFW_count_site_data_public_2021%>%head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 62\n  loc_id  proj_period_id yard_type_pavement yard_type_garden yard_type_landsca\n  <chr>   <chr>                       <dbl>            <dbl>             <dbl>\n1 L100016 PFW_2002                        0                0                 1\n2 L100016 PFW_2003                        0                0                 1\n3 L100016 PFW_2004                        0                0                 1\n4 L100016 PFW_2005                        0                0                 1\n5 L100016 PFW_2006                        0                0                 1\n6 L100016 PFW_2007                        0                0                 1\n# ℹ 57 more variables: yard_type_woods <dbl>, yard_type_desert <dbl>,\n#   hab_dcid_woods <dbl>, hab_evgr_woods <dbl>, hab_mixed_woods <dbl>,\n#   hab_orchard <dbl>, hab_park <dbl>, hab_water_fresh <dbl>,\n#   hab_water_salt <dbl>, hab_residential <dbl>, hab_industrial <dbl>,\n#   hab_agricultural <dbl>, hab_desert_scrub <dbl>, hab_young_woods <dbl>,\n#   hab_swamp <dbl>, hab_marsh <dbl>, evgr_trees_atleast <dbl>,\n#   evgr_shrbs_atleast <dbl>, dcid_trees_atleast <dbl>, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tuesdata$PFW_2021_public %>% janitor::clean_names()\n\n\nd%>% \n  count(year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n   year     n\n  <dbl> <int>\n1  2020 30286\n2  2021 69714\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nworld <- map_data(\"world\")\nstates <- map_data(\"state\")\n\nprop_df <- d %>%\n  filter(longitude < -50) %>%\n  group_by(longitude, latitude, year) %>%\n  reframe(prop_many = how_many / sum(how_many) * 100)\n\n\nggplot(data = world, mapping = aes(long, lat, group = group)) +\n  geom_polygon(color = \"grey\", fill = NA) +\n  geom_polygon(data = states,\n               linewidth=0.1,\n               color = \"grey\",\n               fill = NA) +\n  geom_point(\n    data = prop_df,\n    mapping = aes(x = longitude, y = latitude, fill = factor(year)),\n    inherit.aes = FALSE,\n    key_glyph = \"rect\",\n    size=0.5,\n    shape = 21,\n    stroke = 0.3,\n    color = \"black\"\n  ) +\n  scale_fill_manual(values=c(\"#fc1c3c\",\"#9189c1\"))+\n  coord_sf(xlim = c(-157.94932, -50),\n           ylim = c(20 , 65.51989)) +\n  #facet_wrap(vars(year),nrow = 2) +\n  labs(title = \"Maximum number of individuals seen at one time during observation period\",\n       subtitle=\"total proportion (%)\",\n       caption=\"DataSource: #TidyTuesday 2023 week2 - BFW data\\nDataViz: Federica Gazzelloni #30DayChartChallenge 2023 Day4 - historical\\n\",\n       fill = \"Year\") +\n  ggthemes::theme_map(base_size = 10, base_family = \"Roboto Condensed\") +\n  theme(plot.background = element_rect(color=\"black\",fill=\"black\"),\n        panel.background = element_rect(color=\"black\",fill=\"black\"),\n        plot.title = element_text(color=\"#9189c1\",size=14),\n        plot.subtitle = element_text(color=\"#9189c1\",size=12),\n        plot.caption = element_text(color=\"#fc1c3c\"),\n        legend.position = c(0.85,0.1))\n```\n\n::: {.cell-output-display}\n![](w2_BFWd_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"images/map.png\",\n       width = 7,height = 4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd%>%count(species_code,sort=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 361 × 2\n   species_code     n\n   <chr>        <int>\n 1 daejun        5465\n 2 dowwoo        5449\n 3 norcar        5438\n 4 houfin        4955\n 5 moudov        4938\n 6 bkcchi        4696\n 7 blujay        4578\n 8 amegfi        4446\n 9 whbnut        4393\n10 tuftit        3680\n# ℹ 351 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fpp3)\ndata <- d %>%\n  mutate(date=paste0(month,\"-\",day,\"-\",year),.after =obs_id )%>%\n  mutate(date=as.Date(date,\"%m-%d-%Y\"))%>%\n  select(year,month,day,date,how_many)%>%\n  distinct()%>%\n  group_by(date)%>%\n  reframe(how_many=sum(how_many))\n\nts <- data%>%\n  as_tsibble()\n\nts %>%\n  #autoplot()\n  gg_season(y = how_many,period = \"week\")+\n  scale_colour_steps2() +\n  labs(title=\"Feeder Birds seasonality\",\n       subtitle=\"Exploring Daily Seasonal Patterns of Feeder Bird Sightings\",\n       y=\"number of individuals seen\",x=\"Day of the week (2020-2021)\" )+\n  theme_linedraw(base_size = 12,\n                 base_family = \"Roboto Condensed\")+\n  theme(plot.title = element_text(size=18),\n        plot.subtitle = element_text(size=14))\n```\n\n::: {.cell-output-display}\n![](w2_BFWd_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"images/daily.png\",width = 7,height = 4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts %>%\n  autoplot()+\n  scale_colour_steps2() +\n  labs(title=\"Feeder Birds seasonality\",\n       subtitle=\"Exploring Monthly Seasonal Patterns of Feeder Bird Sightings\",\n       y=\"number of individuals seen\",x=\"Months (2020-2021)\" )+\n  theme_linedraw(base_size = 12,\n                 base_family = \"Roboto Condensed\")+\n  theme(plot.title = element_text(size=18),\n        plot.subtitle = element_text(size=14))\n```\n\n::: {.cell-output-display}\n![](w2_BFWd_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"images/monthly.png\",width = 7,height = 4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cowplot)\n\nggdraw()+\n  draw_image(\"images/map.png\")+\n  draw_image(\"images/daily.png\",scale = 0.25,x=-0.36,y=-0)+\n  draw_image(\"images/monthly.png\",scale = 0.25,x=-0.36,y=-0.27)+\n  draw_label(\"Map of locations from which Project FeederWatch participants have submitted data\\nbetween 2020 and 2021. The inset plots provides detail of an example of seasonality.\",x=0.02,y=0.07,size=6,color=\"grey\",fontfamily = \"Roboto Condensed\",hjust = 0)\n```\n\n::: {.cell-output-display}\n![](w2_BFWd_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"w2_BFWd.png\",width = 7,height = 4,dpi=320)\n```\n:::\n",
    "supporting": [
      "w2_BFWd_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}