{
  "hash": "16ab1c017d5e3b537213ef6b5a832353",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'HDX data Map'\nsubtitle: 'Welcome to #30DayMapChallenge 2024 Day 8'\ndate: '2024-11-08'\nimage: 'https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2024/day8_hdx/day8_hdx.png'\nimage-alt: 'day8_hdx'\ndescription: 'HDX data Map'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\n\n![HDX data Map](https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2024/day8_hdx/day8_hdx.png)\nLoad the required libraries and data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install the hdxr package from GitHub\n# remotes::install_gitlab(\"dickoa/rhdx\")\n```\n:::\n\n\n\n\n\nSet the HDX site to \"prod\" and check the configuration settings.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rhdx)\nset_rhdx_config(hdx_site = \"prod\")\nget_rhdx_config()\n```\n:::\n\n\n\n\nSearch for Ukraine data on HDX and list the datasets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- search_datasets(\"ukraine\")\ndat[2]\n```\n:::\n\n\n\n\nSelect the second dataset and display the metadata: ukraine-border-crossings\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nborder_crossing <- dat[2]\n```\n:::\n\n\n\n\nDisplay the resources available in the dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUKR_data <- border_crossing %>%\n  nth(1) %>%\n  get_resource(1) %>%\n  read_resource() \n\nUKR_data %>% head() %>% glimpse()\n```\n:::\n\n\n\n\nSearch for Ukraine administrative boundaries data on HDX.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 <- search_datasets(\"Ukraine administrative boundaries\")\n```\n:::\n\n\n\n\nAnd select the first dataset and display the metadata: kontur-boundaries-ukraine\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboundaries <- search_datasets(\"kontur-boundaries-ukraine\")\nboundaries[1]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkontur_boundaries_ukraine <- boundaries[1]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresource <- kontur_boundaries_ukraine %>%\n  nth(1) %>%\n  get_resource(1)\n\nresource\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresource$get_format()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfile_path <- resource$download()\nfile_path\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfile.info(file_path)$size\n```\n:::\n\n\n\n\n\nUnzip the file\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(R.utils)\ngunzip(file_path, \n       destname = decompressed_file, \n       overwrite = TRUE)\n```\n:::\n\n\n\n\nRead the shapefile\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nukraine_boundaries <- sf::st_read(decompressed_file)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_boundaries\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap <- ggplot(ukraine_boundaries) +\n  geom_sf()\nmap\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap +\n  geom_sf(data = UKR_data, \n          shape = 4,\n          color=\"red\", \n          size=2) +\n  ggthemes::theme_map() +\n  labs(title = \"Ukraine Border Crossings\",\n       subtitle = \"Data from HDX\",\n       caption = \"Source: HDX | #30DayMapChallenge 2024 Day8 |Created by @fgazzelloni\",\n       fill = \"Population\") \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ukraine_boundaries) +\n  geom_sf(aes(fill = population)) +\n  geom_sf(data = UKR_data, \n          shape = 4,\n          color=\"red\", \n          size=2) +\n  scale_fill_viridis_c() +\n  ggthemes::theme_map() +\n  labs(title = \"Ukraine Border Crossings\",\n       subtitle = \"Data from HDX\",\n       caption = \"Source: HDX | #30DayMapChallenge 2024 Day8 |Created by @fgazzelloni\",\n       fill = \"Population\") \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ukraine_boundaries) +\n  geom_sf(aes(color = population)) +\n  geom_sf(data = UKR_data, \n          shape = 4,\n          color=\"red\", \n          size=2) +\n  scale_color_gradient(low = \"navy\", high = \"gold\",) +\n  ggthemes::theme_map() +\n  labs(title = \"Ukraine Border Crossings\",\n       subtitle = \"Data from HDX\",\n       caption = \"Source: HDX | #30DayMapChallenge 2024 Day8 |Created by @fgazzelloni\",\n       fill = \"Population\") \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_boundaries%>%\n  count(admin_level)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_boundaries%>%\n  count(name_en)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_pop <- ukraine_boundaries%>%\n  group_by(name_en) %>%\n  reframe(geom,population = sum(population)) %>%\n  arrange(desc(population)) \n\nukraine_pop\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_pop %>%\n  filter(name_en == \"Ukraine\") %>%\n  ggplot()+\n  geom_sf(aes(geometry=geom)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_pop %>%\n  filter(!name_en == \"Ukraine\") %>%\n  ggplot()+\n  geom_sf(aes(geometry=geom, fill = population)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_pop %>%\n  filter(!name_en == \"Ukraine\") %>%\n  ggplot()+\n  geom_sf(aes(geometry=geom, \n              fill = population, \n              color = population)) +\n  geom_sf(data = UKR_data, \n          shape = 4,\n          color=\"red\", \n          size=2) +\n  ggthemes::theme_map() +\n  labs(title = \"Ukraine Border Crossings\",\n       subtitle = \"Data from HDX\",\n       caption = \"Source: HDX | #30DayMapChallenge 2024 Day8 |Created by @fgazzelloni\",\n       fill = \"Population\") +\n  scale_fill_viridis_c(\n    name = \"Population\",\n    labels = scales::label_comma(),\n    guide = \"colourbar\"  # Show legend for 'fill'\n  ) +\n  scale_color_viridis_c(\n    guide = \"none\"  # Suppress legend for 'color'\n  ) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_boundaries %>%\n  filter(!name_en == \"Ukraine\") %>%\n  ggplot() +\n  geom_sf(aes(fill = population)) +\n  geom_sf(data = UKR_data, \n          shape = 4,\n          color=\"red\", \n          size=2) +\n  scale_fill_viridis_c(name = \"Population\",\n                       labels = scales::label_comma(),\n                       guide = \"colourbar\") +\n  labs(title = \"Ukraine Border Crossings\",\n       subtitle = \"Data from HDX\",\n       caption = \"Source: HDX | #30DayMapChallenge 2024 Day8 |Created by @fgazzelloni\",\n       fill = \"Population\") +\n  ggthemes::theme_map() +\n  theme(\n    plot.title = element_text(\n      size = 24,\n      face = \"bold\", \n      color = \"darkred\",  \n      hjust = 0.5),\n    plot.subtitle = element_text(\n      size = 14,\n      face = \"italic\",\n      color = \"gray50\",\n      hjust = 0.5)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nukraine_boundaries %>%\n  filter(!name_en == \"Ukraine\") %>%\n  ggplot() +\n  geom_sf(aes(fill = population)) +\n  geom_sf(data = UKR_data, \n          shape = 4,\n          color=\"red\", \n          size=2) +\n  scale_fill_viridis_c(name = \"Population\",\n                       labels = scales::label_comma(),\n                       guide = \"colourbar\") +\n  labs(title = \"Ukraine Border Crossings\",\n       subtitle = \"Data from HDX\",\n       caption = \"Source: HDX | #30DayMapChallenge 2024 Day8 |Created by @fgazzelloni\",\n       fill = \"Population\") +\n  ggthemes::theme_map() +\n  theme(\n    plot.title = element_text(\n      size = 24,\n      face = \"bold\", \n      color = \"darkred\",  \n      hjust = 0.5),\n    plot.subtitle = element_text(\n      size = 14,\n      face = \"italic\",\n      color = \"gray50\",\n      hjust = 0.5),\n    plot.caption = element_text(\n      size = 10,\n      face = \"italic\",\n      color = \"gray50\",\n      hjust = 0.5))\n```\n:::\n\n\n\n\nSave the plot as a PNG file\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"day8_hdx.png\", \n       bg = \"white\",\n       width = 8, height = 6, \n       dpi = 300) \n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}