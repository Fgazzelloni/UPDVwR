{
  "hash": "06ca6ab50e5d29a3f1ec3235f161d515",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Conflicts Map'\nsubtitle: 'Welcome to #30DayMapChallenge 2024 Day 21'\ndate: '2024-11-21'\nimage: 'https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2024/day21_conflicts/day21_conflicts.png'\nimage-alt: 'day21_conflicts'\ndescription: 'Conflicts Map'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\n![Conflicts Map](https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2024/day21_conflicts/day21_conflicts.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"https://ourworldindata.org/grapher/death-rate-in-armed-conflicts.csv?v=1&csvType=full&useColumnShortNames=true\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf%>%filter(Entity==\"Spain\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndeath_rate <- df %>%\n  filter(Year>=2018,\n         death_rate__conflict_type_all>0) %>% # 2018 - 2023\n  group_by(Entity,Code) %>%\n  reframe(Deaths = round(mean(death_rate__conflict_type_all),2))\ndeath_rate\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDataExplorer::profile_missing(death_rate)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndeath_rate%>%filter(Entity==\"Spain\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nworld <- ne_countries(scale = \"medium\", returnclass = \"sf\") %>%\n  filter(!name==\"Antarctica\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndeath_rate_sf <- left_join(world, death_rate, by = c(\"iso_a3\" = \"Code\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntext <- c(\"The best estimate of the number of deaths of combatants and civilians due to fighting in interstate, intrastate, extrasystemic, non-state conflicts, and one-sided violence that were ongoing that year, per 100,000 people. - Our World in Data\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap <- ggplot(data = world) +\n  geom_sf(fill=NA) +\n  geom_sf(data = death_rate_sf, \n          aes(fill=Deaths)) +\n    labs(title = \"Armed Conflicts (2018-2023)\",\n         caption = \"Data Source: Uppsala Conflict Data Program (2024)\\nNatural Earth (2022), Population based on various sources (2024)\\nwith major processing by Our World in Data\\n#30DayMapChallenge Day21 | @fgazzelloni\",\n       fill = \"Death Rate\\n(Avg-values)\") +\n  ggthemes::theme_map() +\n  theme(text = element_text(family = \"mono\", color = \"grey20\", face=\"bold\"),\n        legend.position = \"top\",\n        legend.background = element_rect(fill=\"transparent\"),\n        plot.title = element_text(size=20),\n        plot.caption = element_text(size=9))\n\nmap\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap +\n  scale_fill_continuous(low = \"lightblue\", high = \"darkred\") +\n  ggtext::geom_textbox(\n  x = -135, y = -45, \n  width = 0.3, height = 0.5,\n  label = text, \n  size = 3, \n  family = \"mono\",\n  color = \"darkred\", \n  fill = \"transparent\",\n  box.color = \"transparent\"\n  ) \n```\n:::\n\n\nsave it as png\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"day21_conflicts.png\",\n       bg=\"grey80\",\n       width = 12, height = 6, \n       units = \"in\", dpi = 300)\n```\n:::\n",
    "supporting": [
      "day21_conflicts_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}