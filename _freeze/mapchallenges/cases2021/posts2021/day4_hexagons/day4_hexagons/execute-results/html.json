{
  "hash": "dbbbe1123f57fa7a7f73e139c94d0e31",
  "result": {
    "markdown": "---\ntitle: 'Hexagons'\nsubtitle: 'Welcome to #30DayMapChallenge 2021 day 4'\ndate: '2021-11-4'\nimage: 'day4_hexagons.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nlibrary(sf)\nlibrary(raster)\n\n\nlibrary(spData)\nlibrary(spDataLarge) \n\nlibrary(tmap)    # for static and interactive maps\nlibrary(leaflet) # for interactive maps\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_df <- spData::boston.c\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nleaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  setView(lng = -71.0589, lat = 42.3601, zoom = 12)\n```\n:::\n\n\nsave the leaflet map as .png\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\nlibrary(rcartocolor)\n\n\nlibrary(ggimage)\nbck_color <- \"#FEFCEF\"\n\nimage<- \"/Users/federica/Documents/R/R_general_resources/30DayMapChallenge/day4_hexagons/boston_city.png\"\n\nmain_plot<-my_df %>%\n  ggplot(aes(x=LON,y=LAT,group=CHAS,FILL=TRACT))+\n  geom_path(color=\"grey70\",size=0.2)+\n  geom_hex(color=\"grey60\",size=0.2,bins=60,alpha=0.8)+\n  geom_point(data=my_df,aes(x=LON,y=LAT,group=LSTAT),shape=\".\",color=\"gold\",alpha=0.7)+\n  scico::scale_fill_scico(palette = \"bilbao\")+\n  ggthemes::theme_map()\n\ng<-ggimage::ggbackground(main_plot, image, alpha=.7)\ng\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(us.cities)\n\n ma<-us.cities%>%filter(country.etc==\"MA\")\n range(ma$lat)\n range(ma$long)\n\nboston<-us.cities%>%filter(str_detect(name,\"Boston\"))\ncapitals <- subset(us.cities, capital == 2)\n\n\nma_section<- ggplot(data=capitals,aes(long, lat)) +\n  borders(\"state\", xlim = c(-71.5, -70.08), ylim = c(41.55 ,42.5), fill = hcl.colors(286, \"BrwnYl\")) +\n  geom_hex(data=my_df,mapping=aes(x=LON,y=LAT,group=RAD),bins=90,show.legend = F)+\n  geom_point(boston, mapping=aes(long, lat),color=\"red\") +\n  geom_point(data=my_df,aes(x=LON,y=LAT,group=LSTAT),shape=\".\",color=\"gold\",alpha=0.4)+\n  rcartocolor::scale_fill_carto_c(type = \"diverging\", palette = \"Fall\", direction = -1)+\n  coord_quickmap()+\n  theme_nothing()+\n  theme(plot.background = element_rect(fill=\"grey80\",color=\"grey80\"),\n        panel.background = element_rect(fill=\"grey80\",color=\"grey80\"))\n\nma_section<-ma_section+\n  theme_gray()+\n  theme(axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        axis.title = element_blank(),\n        plot.background = element_rect(fill=\"grey95\",color=\"grey80\"),\n        panel.grid.major.x = element_blank())\n\n# save final plot\nragg::agg_png(here::here(\"~/Documents/R/R_general_resources/30DayMapChallenge/day4_hexagons/ma_section.png\"),\n              res = 320, width = 12, height = 8.5, units = \"in\")\nma_section\ndev.off()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(extrafont)\nloadfonts()\nfonts()\nfamily<- \"Scooby Doo\"\n# final touches\nlibrary(cowplot)\nlibrary(magick)\n\nimage_ma_section<- magick::image_read(\"~/Documents/R/R_general_resources/30DayMapChallenge/day4_hexagons/ma_section.png\")\n\nimage_boston_sym <- magick::image_read(\"~/Documents/R/R_general_resources/30DayMapChallenge/day4_hexagons/boston_symbol.png\")\n\nfinal <- cowplot::ggdraw(g)+\n  draw_image(image_ma_section,x = 0.05, y = -0.41,width = 0.15)+\n  draw_image(image_boston_sym,x = 0.008, y = 0.42,width = 0.08)+\n  draw_label(label=\"Datasource: {spData} Boston.c\\nInfographic: Federica Gazzelloni\",x=0.5,y=0.05, fontfamily = family) +\n  draw_label(label=\"Boston city lower status population\\npercentage values\",x=0.45,y=0.93, fontfamily = family,size=30)\n\n# save final plot\nragg::agg_png(\"~/Documents/R/R_general_resources/30DayMapChallenge/day4_hexagons/hexagons.png\",\n              res = 320, width = 12, height = 8.5, units = \"in\")\nfinal\ndev.off()\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}