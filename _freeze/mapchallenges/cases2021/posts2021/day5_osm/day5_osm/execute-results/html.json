{
  "hash": "6797dc7d8d4915be18b87774a337940d",
  "result": {
    "markdown": "---\ntitle: 'Osm'\nsubtitle: 'Welcome to #30DayMapChallenge 2021 day 5'\ndate: '2021-11-5'\nimage: 'day5_osm.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\nsource: https://parametricsforarchitecture.wordpress.com/2020/07/21/urban-design-masterplanning-desktop-analysis-automation-through-rstudio-and-shiny/\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(osmdata)\nlibrary(leaflet)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\navailable_tags(\"water\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation <- \"Berlin\"\n\nberlin_osm <- getbb(location)%>%\n  opq()%>%\n  add_osm_feature(\"water\")%>%\n  osmdata_sf()\n\n\nberlin_water <- berlin_osm$osm_points\n\nberlin_water%>%head\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nberlin_geo <- data.frame(berlin_water$osm_id, \n                         berlin_water$geometry)\n\nnames(berlin_geo)[1]<- \"osm_id\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nberlin_data <- merge.data.frame(berlin_water, berlin_geo)\n\ncoord <- data.frame(st_coordinates(berlin_data$geometry))\nberlin_data$X <- coord$X\nberlin_data$Y <- coord$Y\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(magick)\nimg <- magick::image_read(\"~/Documents/R/R_general_resources/30DayMapChallenge/day5_osm/logo.png\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap <- leaflet() %>%\n  addTiles() %>%\n  setView(lat=52.517317, lng=13.412364, zoom = 14) %>%\n  \n  addProviderTiles(providers$Stamen.Toner)  %>%\n  addProviderTiles(providers$Stamen.TonerLines,\n                   options = providerTileOptions(opacity = 0.35)) %>%\n  addProviderTiles(providers$Stamen.TonerLabels)%>%\n  \n  addCircleMarkers(data = berlin_data,\n                   lat = ~Y,\n                   lng = ~X,\n                   radius = 2.5,\n                   popup = ~water,\n                   color = \"midnightblue\") %>%\n  addCircleMarkers(data = berlin_data,\n                   lat = ~Y,\n                   lng = ~X,\n                   radius = 0.05,\n                   popup = ~water,\n                   color = \"cyan\")\n```\n:::\n\n\nsave the plot as .png\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(extrafont)\nlibrary(showtext)\nfont_add_google(\"Schoolbell\", \"bell\")\nshowtext_opts(dpi = 320)\nshowtext_auto(enable = T)\n\n\n\nplot <- ggplot()+\n  geom_blank()+\n  xlim(0,1932) + ylim(0,1326)+\n  theme_void()+\n  theme(plot.background = element_rect(color = \"grey14\",fill=NA, size=3))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cowplot)\nlibrary(magick)\n\nimage_map<- magick::image_read(\"~/Documents/R/R_general_resources/30DayMapChallenge/day5_osm/map.png\")\n\n\nfinal <- cowplot::ggdraw(plot)+\n  draw_image(image_map,x = 0.02, y = 0,width =0.95)+\n  draw_label(label=\"Datasource: {osmdata} #30DayMapChallenge Day5 - map: Federica Gazzelloni\",x=0.5,y=0.03,\n             fontfamily = \"bell\") +\n  draw_label(label=\"BERLIN WATER\",x=0.45,y=0.92,size=50,fontfamily = \"bell\",fontface=\"bold\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# save final plot\nragg::agg_png(\"~/Documents/R/R_general_resources/30DayMapChallenge/day5_osm/osmdata.png\",\n              res = 320, width = 11, height = 8, units = \"in\")\nfinal\ndev.off()\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}