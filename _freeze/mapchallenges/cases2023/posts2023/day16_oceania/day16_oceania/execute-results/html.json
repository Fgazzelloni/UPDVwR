{
  "hash": "42298272523874253aff0db3fa299940",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Oceania'\nsubtitle: 'Welcome to #30DayMapChallenge 2023 day 16'\ndate: '2023-11-16'\nimage: 'https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2023/day16_oceania/day16_oceania.png'\nimage-alt: ''\ndescription: ''\noutput: html_document\nexecute: \n   eval: false\n   message: false\n   warning: false\n---\n\n\n\n\n\n# Overview\n\n\nThis map of Oceania shows Population Peaks of Oceania's Cities. \n\n\n<center>\n![](https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2023/day16_oceania/day16_oceania.png)</center>\n\nOceania is divided into:\n\n- `Australasia` (largest city: `Sydney`)\n- `Melanesia` (largest city: `Jayapura`)\n- `Micronesia` (largest city: `Tarawa`)\n- `Polynesia` (largest city: `Honolulu`)\n\n\nData is scraped from `Wikipedia`: <https://en.wikipedia.org/wiki/Oceania>\n\n\nLoad necessary libraries:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(ggmap)\nlibrary(sf)\nlibrary(rnaturalearth)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noceania <- read_html(\"https://en.wikipedia.org/wiki/Oceania\")\n\noceania %>%\n  html_nodes(\"table\") %>%\n  .[[2]] %>%\n  html_table(fill = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noceania_rank <- oceania %>%\n  html_nodes(\"table\") %>%\n  .[[3]] %>%\n  html_table(fill = TRUE,header = F)\n\n# distinct(oceania_rank[-c(1,2),1])\n# distinct(oceania_rank[-c(1,2),10])\noceania_rank_tb <- oceania_rank[-c(1,2),-c(1,10)]\nnames(oceania_rank_tb) <- oceania_rank[2,-c(1,10)]%>%unlist()\noceania_rank_tb <- rbind(oceania_rank_tb[1:4],oceania_rank_tb[5:8])%>%\n  drop_na()%>%\n  janitor::clean_names()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncity.geo <- geocode(oceania_rank_tb$city_name)\n\noceania_city.geo <- cbind(oceania_rank_tb,city.geo)%>%\n  mutate(city_name=gsub(\"[, ].*$\",\"\",city_name))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nworldmap <- ne_countries(scale = 'large', type = 'map_units',\n                         returnclass = 'sf')\n# have a look at these two columns only\nhead(worldmap[c('name', 'continent')])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noceania_basemap <- worldmap[worldmap$continent == 'Oceania',]\nggplot() + \n  geom_sf(data = oceania_basemap) + \n  coord_sf(crs='ESRI:54009')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_sf(data = oceania_basemap) + \n  coord_sf( crs= \"+proj=ortho +lat_0=-25 +lon_0=120\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noceania_city.geo_sf<- oceania_city.geo%>%\n  st_as_sf(coords = c(\"lon\",\"lat\"),crs=\"EPSG:4326\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_sf(data = oceania_basemap) + \n  geom_sf(data=oceania_city.geo_sf,\n          mapping=aes(size=pop),\n          shape=21,stroke=0.5,show.legend = F)+\n  coord_sf(crs= \"+proj=ortho +lat_0=-25 +lon_0=120\")+\n  ggthemes::theme_map()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\northo<- \"+proj=ortho +lat_0=-15.736352 +lon_0=171.740558\"\nocean <- st_point(x = c(0,0)) %>%\n  st_buffer(dist = 6371000) %>% #6,371km ratius of the earth\n  st_sfc(crs = ortho)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noceania_city.geo_sf_coords <- oceania_city.geo_sf%>%\n  sf::st_coordinates()%>%\n  cbind(oceania_city.geo_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tmap)\ndata(\"World\")\nplot(World)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#devtools::install_github(\"signaux-faibles/rsignauxfaibles\")\nlibrary(rsignauxfaibles)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noceania_city.geo%>%\n  count(city_name)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncity.colors <- rep(RColorBrewer::brewer.pal(10,\"Set3\"),2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_sf(data = ocean, \n          fill = \"#3e5d8b\", \n          color = \"#263c52\") + #grey34\n  geom_sf(data = World,fill=\"grey64\",alpha=0.5) + \n  geom_sf(data = oceania_basemap,\n          fill=\"#43605b\",color=\"grey64\",\n          alpha=0.5) + \n  geom_sf(data=oceania_city.geo_sf,\n          mapping=aes(size=pop,color=city_name),\n          fill=\"grey\",\n          #color=\"grey34\",\n          alpha=0.2,\n          shape=21,stroke=0.7,\n          show.legend = F)+\n  scale_size_discrete()+\n  ggnewscale::new_scale(new_aes = \"size\")+\n  geom_sf_text(data=oceania_city.geo_sf_coords,\n            mapping=aes(x=X,y=Y,label=city_name,size=pop), \n            nudge_x = c(0, .15, rep(0, 10), 0, 0),\n            nudge_y = c(0, -.2, rep(0, 10), -.15, 0),\n            fun.geometry = sf::st_centroid,\n            #size=1.9,\n            color=\"white\",\n            face=\"bold\",\n            family=\"Roboto Condensed\")+\n  scale_size_manual(values=seq(0.5,2,0.075))+\n  coord_sf(crs= ortho)+\n  labs(title=\"Population Peaks: Exploring Oceania's Cities\",\n       caption = \"#30DayMapChallenge 2023 Day 16 Oceania\\nDataSource: Wikipedia | Map: @fgazzelloni\")+\n  ggthemes::theme_map()+\n  theme(text=element_text(family = \"Roboto Condensed\",face=\"bold\",size=14,color=\"white\"),\n        plot.title = element_text(hjust=0.5),\n        plot.caption = element_text(hjust=0.5),\n        legend.position = \"none\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"day16_oceania.png\",bg=\"#263c52\")\n```\n:::\n\n\n\n\n\n## References\n\n- <https://en.wikipedia.org/wiki/Oceania>\n- <https://www.r-bloggers.com/2019/04/zooming-in-on-maps-with-sf-and-ggplot2/>\n- <https://gist.github.com/rafapereirabr/26965dd851debad32ad2e659024ba451>\n- <https://rpubs.com/mdavril_gsu/794598>\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}