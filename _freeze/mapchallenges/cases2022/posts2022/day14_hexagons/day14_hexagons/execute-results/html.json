{
  "hash": "8aa65b636be7f1b7ee60b69787f96539",
  "result": {
    "markdown": "---\ntitle: 'Hexagons'\nsubtitle: 'Welcome to #30DayMapChallenge 2022 day 14'\ndate: '2022-11-14'\nimage: 'day14_hexagons.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the library\nlibrary(tidyverse)\nlibrary(geojsonio)\nlibrary(sf)\n# Set the fonts\nlibrary(showtext)\nlibrary(sysfonts)\nlibrary(extrafont)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\nfont_add_google(name=\"Island Moments\",\n                family=\"Island Moments\")\n\n\n\nus_covid <- read_csv(\"~/Documents/R/R_general_resources/30DayMapChallenge/2022/day14_hexagons/data/covid_cases_by_County.csv\")\n\n\ncovid_data <- us_covid%>%\n  select(county,\n         county_fips,\n         state,\n         county_population,\n         covid_cases_per_100k) %>%\n  distinct()\n\n\n# source: https://walker-data.com/tidycensus/reference/get_decennial.html\nlibrary(tidycensus)\noptions(tigris_use_cache = TRUE)\n\n\ntarr <- get_acs(geography = \"county\",\n                variables = \"B19013_001\",\n                geometry = TRUE, \n                year = 2020)\n\n# save(tarr,file=\"data/tarr.RData\")\nload(\"data/tarr.RData\")\n\ntarr%>%count(NAME)\n\ntarr2 <- tarr%>%\n  separate(NAME,into=c(\"county\",\"name\"),remove=F,sep=\",\")\n\n\ncoords <- tarr2%>%\n  st_centroid() %>%\n  st_coordinates() \n\n# check the dimensions\ntarr2%>%dim\ncoords%>%dim\ncovid_data%>%dim\n\nfull <- cbind(tarr2,coords)\n\ndf <- covid_data%>%\n  left_join(full,by=c(\"county\"=\"county\")) %>%\n  distinct()%>%\n  mutate(county=as.factor(county))\n\ndf2 <- covid_data%>%\n  left_join(tarr2,by=c(\"county\"=\"county\")) %>%\n  distinct()\n\n\ndf3 <- df2%>%\n  st_as_sf()\n\n\ndf%>%DataExplorer::profile_missing()\n# A tibble: 12 Ã— 3\n# feature              num_missing pct_missing\n# <fct>                      <int>       <dbl>\n#   1 county                         0  0         \n# 2 county_fips                    0  0         \n# 3 state                          0  0         \n# 4 county_population              1  0.00000180\n# 5 covid_cases_per_100k           0  0         \n# 6 GEOID                       4911  0.00884   \n# 7 NAME                        4911  0.00884   \n# 8 name                        4911  0.00884   \n# 9 variable                    4911  0.00884   \n# 10 estimate                    4987  0.00898   \n# 11 moe                         4987  0.00898   \n# 12 geometry                       0  0   \n\n\n\n  ggplot()+\n# geom_point(data= df, aes(X,Y),inherit.aes = F)+\n  stat_summary_hex(data= df, aes(x=X,y=Y,z=covid_cases_per_100k),\n           linewidth=0.01,\n           inherit.aes = F)+\n    geom_sf(data=tarr2,aes(geometry=geometry),\n            fill=NA,\n            linewidth=0.05)+\n   coord_sf(xlim = c(-125,-68),ylim = c(20,50))+\n    scale_fill_viridis_c(option = \"H\")+\n    labs(title=\"United States of America\",\n         subtitle = \"Covid Cases per 100k\",\n         fill=\"Value\",\n         caption=\"#30DayMapChallenge 2022 Day 14: Hexagons\\nDataSource: CDC Covid data & Census data from {tidycensus}\\nMap: Federica Gazzelloni (@fgazzelloni)\")+\n    ggthemes::theme_map()+\n    theme(plot.caption = element_text(lineheight = 1.5,size=5),\n          plot.title = element_text(size=14),\n          legend.background = element_blank())\n\n  \n  ggsave(\"day14_hexagons.png\",\n         bg=\"grey90\",\n         width=6.78,\n         height = 5.78,\n         dpi=200)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}