{
  "hash": "f4f03ae1a913e3696274b0b69eb46f21",
  "result": {
    "markdown": "---\ntitle: 'Color friday red'\nsubtitle: 'Welcome to #30DayMapChallenge 2022 day 11'\ndate: '2022-11-11'\nimage: 'day11_color_friday_red.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nraw_contour <- read_delim(\n  \"data/FM_service_contour_current.txt\",\n  delim = \"|\"\n)\n\nconv_contour <- raw_contour |>\n  select(-last_col()) |>\n  set_names(nm = c(\n    \"application_id\", \"service\", \"lms_application_id\", \"dts_site_number\", \"transmitter_site\",\n    glue::glue(\"deg_{0:360}\")\n  ))\n\nlng_lat <- conv_contour |>\n  separate(\n    transmitter_site, \n    into = c(\"site_lat\", \"site_long\"), \n    sep = \" ,\")\n# save(lng_lat,file= \"data/lng_lat.RData\")\n# load(\"rdata/lng_lat.RData\")\n\ndf_coords <- lng_lat%>%\n  select(-dts_site_number) %>%\n  distinct() %>%\n  drop_na() %>%\n  mutate_all(trimws)%>%\n  mutate(application_id=as.numeric(application_id),\n         site_lat=as.numeric(site_lat),\n         site_long=as.numeric(site_long))\n\ndf_coords %>%\n  as.data.frame() %>%\n  arrange(service) %>%  \n  count(service)\n\ndf_coords1_FM <- df_coords %>%\n  as.data.frame() %>%\n  arrange(service) %>%  #count(service)\n  filter(service==\"Full Service (FM)\") \n\n\ndf_coords1_FB <- df_coords %>%\n  as.data.frame() %>%\n  arrange(service) %>%  #count(service)\n  filter(service==\"FM Boosters (FB)\") \n# save(df_coords1,file=\"rdata/df_coords1_FB.RData\")\n# load(\"rdata/df_coords1_FB.RData\")\n\ndf_coords2 <- df_coords1_FB %>%\n  pivot_longer(cols = deg_0:deg_360,\n               names_to = \"angle\",\n               values_to = \"values\") \n\ndf_coords3 <- df_coords2 %>%\n  mutate(angle = str_remove(angle, \"deg_\"),\n         angle = as.integer(angle))\n\n\ndf_coords4 <- df_coords3 %>%\n  separate(values,\n           into = c(\"deg_lat\", \"deg_lng\"),\n           sep = \" ,\")\n\n\ndf_coords5_FB <- df_coords4 %>%\n  mutate(deg_lat= ifelse(is.na(deg_lng),site_lat,deg_lat),\n         deg_lng= ifelse(is.na(deg_lng),site_long,deg_lng))\n\n# save(df_coords5,file=\"rdata/df_coords5_FB.RData\")\n# load(\"rdata/df_coords5_FB.RData\")\n\nlibrary(sf) # spatiotemporal\nworld <- sf::st_as_sf(maps::map(\"world\", plot = FALSE, fill = TRUE))\nstates <- sf::st_as_sf(maps::map(\"state\", plot = FALSE, fill = TRUE))\n\n\ndf_coords5_FB_sf <- df_coords5_FB %>%\n   st_as_sf(coords=c(8,7),crs=4326) \n\n\n# set the fonts\nlibrary(showtext)\nlibrary(sysfonts)\nlibrary(extrafont)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\nfont_add_google(name=\"Xanh Mono\",family=\"Xanh Mono\")\n\n\n\nlibrary(ggnewscale)\n\nggplot() +\n  geom_sf(data= world, aes(fill=ID),\n          color=\"#590303\",\n          show.legend = F) +\n  scale_fill_viridis_d(alpha = 0.3,\n                       begin = 0.55,\n                       end = 0.35,\n                       option = \"F\") +\n  # geoms below will use another color scale\n  new_scale_color() +\n  geom_sf(data=states,aes(fill=ID),\n          color=\"#8a1313\",\n          linewidth =0.05,\n          show.legend = F) +\n  scale_fill_viridis_d(alpha = 0.3,\n                       begin = 0.55,\n                       end = 0.35,\n                       option = \"F\") +\n  geom_point(data = df_coords1_FM,\n             mapping = aes(site_long,site_lat),\n             shape=\".\",color=\"#e37f78\",\n             inherit.aes = F) +\n  geom_sf(data = df_coords5_FB_sf,\n          shape=21,stroke=0.009,\n          alpha=0.2,\n          fill= NA, #\"#eba7a7\",\n          color=\"#ab251b\",\n          inherit.aes = F) +\n  coord_sf(xlim = c(-171.73031,-55),ylim = c(20,71.29194))+\n  labs(title=\"FM Boosters - FB Radio Stations\",\n       caption=\"FM Boosters contours on central point FM Radio Stations. DataSource: FM Service Contour Data Points (fcc.gov)\\nData provides FM additional services: FM Auxiliary (FS), FM Boosters (FB), Full Service (FM), Low Power FM (FL), Translators (FX).\n       #30DayMapChallenge 2022 Day 11: Color Friday Red & #TidyTuesday 2022 Week 45 Radio Stations | Map: Federica Gazzelloni (@fgazzelloni)\")+\n  theme_classic() +\n  theme(text=element_text(face=\"bold\",color=\"#ab251b\",family=\"Xanh Mono\"),\n        axis.line = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        axis.title = element_blank(),\n        plot.title = element_text(),\n        #plot.margin = margin(5,0,5,0,unit = \"pt\"),\n        plot.caption = element_text(size=5,lineheight = 1.1,hjust=0.5),\n        plot.background = element_rect(fill=\"#e3b7b3\",color=\"#590303\"),# a8a2a2\n        panel.background = element_rect(fill=\"#e3b7b3\",color=\"#590303\"))\n\nggsave(\"day11_color_friday_map.png\",\n       dpi=280,\n       bg=\"white\",\n       width = 6.1,\n       height = 4.3)\n```\n:::\n",
    "supporting": [
      "day11_color_friday_red_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}