{
  "hash": "d2e415cf22e016f667b47d4f6c6e1df2",
  "result": {
    "markdown": "---\ntitle: 'My favourite'\nsubtitle: 'Welcome to #30DayMapChallenge 2022 day 20'\ndate: '2022-11-20'\nimage: 'day20_my_favourite.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\n### TidyTuesday week 6 2022\n\noriginal Dubois collection:\n\n- https://www.loc.gov/collections/african-american-photographs-1900-paris-exposition/?sb=shelf-id_desc&sp=1&st=grid\n- https://github.com/ajstarks/dubois-data-portraits/blob/master/plate01/georgia-negro.dsh\n\n### Load data\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nairmen <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-02-08/airmen.csv')\n\n\n# data wrangling--------\ndf <-airmen%>%\n  select(name,graduation_date,graduated_from,\n         pilot_type,\n         military_hometown_of_record,state,\n         number_of_aerial_victory_credits)%>%\n  mutate(pilot_type=str_replace_all(pilot_type,\"Liaison\",\"Liason\"))%>%\n  filter(!is.na(graduation_date),!is.na(state))%>%\n  arrange(desc(graduation_date))%>%\n  mutate(id=row_number())%>%\n  relocate(id)\n\n# 48 states abbr to be chacked\ndf%>%count(state)\n\ndf%>%mutate(year=lubridate::year(graduation_date))%>%count(year)\n\n# map data -----\nus_states_df <-\n  df%>%\n  mutate(state_name=usdata::abbr2state(state),\n         .after=state)%>% \n  filter(!is.na(state_name)) %>%   # 41 us states selected\n  mutate(state_name = tolower(state_name)) \n\nmy_states<-\n  us_states_df%>%\n  count(state_name)%>%\n  select(-n)%>%unlist()\n\n# US states coordinates \nstates<- map_data(\"state\")\n\nmy_states_coords<- \n  states%>%\n  filter(region%in%my_states)%>%\n  left_join(us_states_df,by=c(\"region\"=\"state_name\"))%>%\n  mutate(number_of_aerial_victory_credits=ifelse(number_of_aerial_victory_credits==1.5,\n                                                 2,number_of_aerial_victory_credits))\n\n# World coordinates\nworld<-map_data(map = \"world\") %>%\n  filter(!region==\"Antarctica\")\n\n\n# alabama $ french morocco\nal_frmo<-data.frame(region=c(\"french morocco\",\"alabama\"),\n                    lat=c(30.427755,32.318230),\n                    long=c(-9.598107,-86.902298))\n\n\n\n# dubois colors -------\nstates_palette<-colorRampPalette(c(\"#654321\",\"#d2b48c\",\"#ffd700\",\"#ffc0cb\",\"#dc143c\",\"#00aa00\",\"#4682b4\"))(5)\n\n# fonts---------\nlibrary(extrafont)\nlibrary(showtext)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\nlibrary(sysfonts)\n#font_families_google()\nfont_add_google(name=\"Barlow Condensed\",family=\"dubois\")\n\n\n# make the map plots ---------------------\n\nworld_west <-\n  ggplot() +\n  geom_polygon(data=world,aes(x=long,y=lat,group=group),\n               fill=\"wheat2\",color=\"#654321\") +\n  geom_polygon(data = states,\n               aes(x = long, y = lat, group = group),\n               fill=\"wheat2\",color=\"#654321\",size=0.1) +\n  \n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==1),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05) +\n  \n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==2),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05) +\n  \n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==3),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05)+  \n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==4),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05)+\n  \n  geom_point(data=al_frmo,aes(x=long,y=lat),color=\"red\")+\n  \n  scale_fill_manual(values=states_palette)+\n  coord_map(\"ortho\", orientation = c(3.849945, -103.525750, 0)) +\n  \n  labs(title=\" \\n \\n \",\n       subtile=\" \\n \\n \",\n       x=\"\",y=\"\",fill=\"Aerial victories\") +\n  theme_void() +\n  theme(legend.position = c(0.5,1.2),\n        legend.direction = \"horizontal\")\n\n\nworld_est <-  \n  ggplot() +\n  geom_polygon(data=world,aes(x=long,y=lat,group=group),\n               fill=\"wheat2\",color=\"#654321\") +\n  geom_polygon(data = states,\n               aes(x = long, y = lat, group = group),\n               fill=\"wheat2\",color=\"#654321\",size=0.1) +\n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==1),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05)+\n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==2),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05)+\n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==3),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05)+  \n  geom_polygon(data = subset(my_states_coords,number_of_aerial_victory_credits==4),\n               aes(x = long, y = lat, group = group,\n                   fill=factor(number_of_aerial_victory_credits)),\n               color=\"#654321\",size=0.05) + \n  \n  geom_point(data=al_frmo,aes(x=long,y=lat),color=\"red\")+\n  \n  scale_fill_manual(values=states_palette)+\n  coord_map(\"ortho\", orientation = c(10.050474, 55.740732,0)) + #9.982182, 49.595135, 0)) + \n  labs(title=\" \\n \\n \",subtile=\" \\n \\n \",x=\"\",y=\"\",color=\"\") +\n  theme_void() +\n  theme(legend.position = \"none\")\n\n\n\n# draw curved text-----------------------\nt<-2*pi\n\ndf_text_left <- \n  data.frame(x = cos(t),\n             y = sin(t),\n             xend = cos(t + 1.8),\n             yend = sin(t + 1.8))\n\np <-ggplot(df_text_left) +\n  geomtextpath::geom_textcurve(aes(x, y, xend = xend, yend = yend),\n                               label = c(\"Afican-American pilots victory\"),\n                               curvature = 0.2, vjust = 1) +\n  coord_equal(xlim = c(-1.1, 1.1), ylim = c(-1.1, 1.2))\n\n\nq <-ggplot(df_text_left) +\n  geomtextpath::geom_textcurve(aes(-x, y, xend =- xend, yend = yend),\n                               label = c(\"Army Air Force during WWII\"),\n                               curvature = -0.2, vjust = -0) +\n  coord_equal(xlim = c(-1.1, 1.1), ylim = c(-1.1, 1.2))\n\nlibrary(patchwork)\ntext_curved <-(p+q)\ntext_curved <- text_curved & theme_void()\n\n# draw circle and a curve-----------\ng <- grid::circleGrob(gp = grid::gpar(fill = \"#baa388\",color=\"#654321\",size=0.5))\n\n\n# final touches----------\nlibrary(cowplot)\nfinal_plot<-ggdraw()+\n  draw_image(\"duboisbg.jpeg\",\n             scale = 1.6)+\n  draw_grob(g, scale=0.542,x=-0.223,y=-0.1) +\n  draw_grob(g, scale=0.542,x=0.229,y=-0.1) +\n  draw_plot(world_west,scale=0.6,x=-0.229,y=-0.07)+\n  draw_plot(world_est,scale=0.6,x=0.229,y=-0.07) +\n  draw_image(\"https://tile.loc.gov/storage-services/service/pnp/ppmsca/33800/33863r.jpg\",\n             scale=0.3,x=0.4,y=0.35) +\n  draw_label(\"#30DayMapChallenge 2022 Day 20: My favourite\\nTuskegee Airmen: Aerial Victories\\nAir Force Historical Research Agency\\nGraduation 1942 - 1948\", \n             fontfamily=\"dubois\",color=\"#291c10\",\n             x=0.5,y=0.9,size=25,fontface = \"bold\")+\n  draw_label(\"DataSource: Tuskegee Airmen | Viz @fgazzelloni \\n #DuBoisChallenge | #TidyTuesday 2022/06\", \n             fontfamily=\"dubois\",color=\"#291c10\",\n             x=0.5,y=0.12,size=14,fontface = \"bold\")+\n  draw_plot(text_curved,x=0,y=0.05,scale = 0.5)+\n  draw_label(\"This paper focus on their aerial victory credits. \n             The most famous of the 332d Fighter Group commanders was Col.Benjamin O. Davis,Jr.\n             The 99th Fighter Squadron deployed from Tuskegee, Alabama, to French Morocco in April 1943.\",\n             fontfamily=\"dubois\",color=\"#291c10\",\n             x=0.5,y=0.04,size=14,fontface = \"bold\")\n\n\n# save the plot--------\nragg::agg_png(\"day20_my_favorite.png\",\n              res = 320, width = 12, height = 10, units = \"in\")\nfinal_plot\n\ndev.off()\n```\n:::\n",
    "supporting": [
      "day20_my_favourite_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}