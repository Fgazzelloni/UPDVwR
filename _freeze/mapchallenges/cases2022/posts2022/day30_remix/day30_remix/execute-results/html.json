{
  "hash": "cda0cc4d6c33f90923bf648fa6aee821",
  "result": {
    "markdown": "---\ntitle: 'Remix'\nsubtitle: 'Welcome to #30DayMapChallenge 2022 day 30'\ndate: '2022-11-30'\nimage: 'day30_remix.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# set the fonts\nlibrary(showtext)\nlibrary(sysfonts)\nlibrary(extrafont)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\nfont_add_google(name=\"Poor Story\",family=\"Poor Story\")\n\nlibrary(leaflet)\n# library(leaflet.extras)\n# library(leaflet.providers)\n\n# fileid<- \"d069b4c5-ec5b-c750-45aa-0a13f57dc35a\"\n#Geographic Bounding Box\n# bbox<- c(174.064747966174,.345239694,-35.2867580621,-35.1399271488)\n\n\nlibrary(tidyverse)\nlibrary(rgdal)\nlibrary(sf)\n# Department of Conservation (DOC) - Campsites. Dataset shows all campsites.\n# https://catalogue.data.govt.nz/dataset/doc-campsites3\nshp <- readOGR(\"data/DOC_Campsites\")\n\nplot(shp)\nshp%>%View\nshp@proj4string\nshp@data%>%\n  ggplot()+\n  geom_point(aes(x,y))\n  \ndf <- shp@data %>%\n  st_as_sf(coords=c(\"x\",\"y\"),\n           crs=\"+proj=tmerc +lat_0=0 +lon_0=173 +k=0.9996 +x_0=1600000 +y_0=10000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0\n+units=m +no_defs\") %>%\n  sf::st_transform(crs = \"+proj=longlat +datum=WGS84\")  %>%\n  tibble() \n\n\ndf1 <- shp@data %>%\n  st_as_sf(coords=c(\"x\",\"y\"),\n           crs=\"+proj=tmerc +lat_0=0 +lon_0=173 +k=0.9996 +x_0=1600000 +y_0=10000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0\n+units=m +no_defs\") %>%\n  sf::st_transform(crs = \"+proj=longlat +datum=WGS84\")  %>%\n  st_coordinates() %>%\n  bind_cols(df) \n\n\ndf2<- df1%>%\n  mutate(dogs=ifelse(dogsAllowe==\"No dogs\",\"no\",\"yes\"),\n         .after=Y)\n\ndf1%>%View\ntable(df2$dogs)\ntable(df2$campsiteCa)\n\ngetColor <- function(df2) {\n  sapply(df2$dogs, function(dogs) {\n    ifelse(dogs == \"yes\",\"green\",\"red\")})\n    }\n\nicons <- awesomeIcons(\n  icon = 'ios-close',\n  iconColor = 'black',\n  library = 'ion',\n  markerColor = getColor(df2)\n)\n\n\n\n\ntile <- \"http://tiles-{s}.data-cdn.linz.govt.nz/services;key=0661036048984cf88489c5930d0c2e98/tiles/v4/layer=NZ512501/EPSG:3857/{z}/{x}/{y}.png\"\n\nislands_mixup <- leaflet(options = leafletOptions(zoomControl = FALSE)) %>% \n  # -35.20870804, 174.22736660.\n  setView(174.22736660,-35.20870804,zoom=14) %>%\n  addTiles() %>%\n  # addProviderTiles(providers$Esri.NatGeoWorldMap,\n  #                  options = providerTileOptions(opacity = 0.35))%>%\n  addWMSTiles(\n    \"https://tiles-cdn.koordinates.com/services;key=0661036048984cf88489c5930d0c2e98/tiles/v4/layer=51306/EPSG:3857/{z}/{x}/{y}.png\",\n    layers = \"51306\",\n    options = WMSTileOptions(format = \"image/png\", \n                             transparent = FALSE),\n    attribution = \"New Zealand Hydrographic Authority\") %>%\n  addAwesomeMarkers(lng = df2$X,\n                    lat = df2$Y, \n                    icon=icons) %>%\n  addMeasure()%>%\n  addMiniMap()\n\nislands_mixup  \n\n\n## load packages\nlibrary(htmlwidgets)\nlibrary(webshot)\n\n\n## save html to png\nsaveWidget(islands_mixup, \"temp.html\", selfcontained = FALSE)\nwebshot(\"temp.html\", file = \"data/islands_mixup.png\",\n        cliprect = \"viewport\")\n\n\n\nlibrary(cowplot)\nggdraw()+\n  draw_image(\"data/islands_mixup.png\")+\n  draw_line(x=c(0,0.99),y=c(0.89),\n            alpha=0.4,\n            color=\"grey95\",size=20)+\n  draw_label(\"Campsites in Urupukapuka Island no dogs allowed\",\n             x=0.5,y=0.95,\n             fontface = \"bold\",\n             fontfamily = \"Poor Story\") +\n  draw_label(\"#30DayMapChallenge 2022 Day 30: Mixup\\nDataSource: New Zealand Hydrographic Authority & data.govt.nz | Graphics: @fgazzelloni\",\n             x=0.5,y=0.90,\n             lineheight = 1.2,\n             fontfamily = \"Poor Story\",\n             size=5) \n\nggsave(\"day30_remix.png\",\n       dpi=200,\n       width = 6.83,\n       height =5.26 )\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}