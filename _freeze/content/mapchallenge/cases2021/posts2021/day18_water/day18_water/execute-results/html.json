{
  "hash": "4f0413a700e0f5a6cc542c18734c5cc6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Water'\nsubtitle: 'Welcome to #30DayMapChallenge 2021 day 18'\ndate: '2021-11-18'\nimage: 'https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2021/day18_water/water.png'\nimage-alt: ''\ndescription: ''\noutput: html_document\nexecute: \n   eval: false\n---\n\n# Overview\n\n`John Snow data` for this map with `read_stars()`. Data is from the `blog.rtwilson.com`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nlibrary(rgdal)\nlibrary(maptools)\nlibrary(ggmap)\nlibrary(sp)\nlibrary(sf)\nlibrary(HistData)\nlibrary(leaflet)\nlibrary(OpenStreetMap)\nlibrary(osmdata)\nlibrary(spData)\n\n\nlibrary(stars)\nlnd_img <- file.path(\"GBD/Comunicable_diseases/John_snow/SnowGIS/OSMap_Grayscale.tif\")\nsat_vis <- read_stars(lnd_img\n                     # RasterIO = list(nBufXSize = 600, nBufYSize = 600)\n                      )\n\n\n\npumps <- st_read(\"GBD/Comunicable_diseases/John_snow/SnowGIS/Pumps.shp\")\npumps <- st_transform(pumps, crs = st_crs(sat_vis))\npumps2<- data.frame(st_coordinates(pumps$geometry))\n```\n:::\n\n\n\nSet the fonts.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(extrafont)\nlibrary(showtext)\n\n\n\n## Automatically use showtext to render text for future devices\nshowtext_auto()\n\n## Tell showtext the resolution of the device,\n## only needed for bitmap graphics. Default is 96\nshowtext_opts(dpi = 320)\n\n## Loading Google fonts (https://fonts.google.com/)\n\nfont_add_google(\"Oswald\", \"oswald\")\n```\n:::\n\n\n\nMake the map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_stars(data = sat_vis, show.legend = FALSE) +\n  scale_fill_viridis_d(alpha = 1,\n                       begin = 0.9,\n                       end = 0,\n                       direction = -1,\n                       option = \"B\",\n                       aesthetics = \"fill\")+\n  geom_polygon(data=pumps2,\n               aes(x = X, y = Y),\n               colour = \"midnightblue\",alpha=0.3)+\n  geom_point(data=pumps2,\n             aes(x = X, y = Y),\n             colour = \"midnightblue\")+\n  geom_point(data = pumps2, aes(x = X, y = Y), shape = 21,\n             colour = \"gold\", fill = NA,\n             size = 7, stroke = 1,inherit.aes = FALSE) +\n    coord_equal()+\n  labs(title=\"John Snow Colera map of the pumps\")+\n  ggthemes::theme_map()+\n  theme(text = element_text())\n```\n:::\n\n\n\nSave it!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nragg::agg_png(\"js_map.png\",\n              res = 320, width = 14, height = 8, units = \"in\")\nfinal\n\ndev.off()\n```\n:::\n\n\n\nAnd restyle it!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cowplot)\nfinal<-ggdraw()+\n  draw_image(\"R_general_resources/30DayMapChallenge/day18_water/js_map.png\",\n             x = 0.01, y = 0,width = 0.98) +\n\n  draw_line(x = c(0.2, 0.8),y = c(0.8, 0.97),color = \"green\", size = 25) +\n  draw_label(label=\"John Snow's 1854 investigation \\nof a Cholera outbreak in London\",\n             x=0.5,y=0.89,size=20,color=\"grey20\",fontface = \"bold\",\n             angle = 12) +\n\n  draw_line(x = c(0.6, 0.9),y = c(0.6, 0.67),color = \"green\", size = 20) +\n  draw_label(label=\"Pumps locations\\nvectors of the infections\",\n             x=0.75, y=0.63, size=16, angle=10,\n             color = \"black\",fontface = \"bold\",\n             lineheight = 1.1,\n             alpha = 1) +\n  draw_line(x = c(0.6, 0.58),y = c(0.6, 0.5),color = \"green\", size = 1) +\n  #draw_grob(g, scale = 0.15,x = 0,y = -0.08)+\n  draw_line(x = c(0.2, 0.805),y = c(0.05, 0.05),color = \"green\", size = 21) +\n  draw_text(\"Datasource: blog.rtwilson.com - #30DayMapChallenge Day18 water\\nInfographics: Federica Gazzelloni\",\n            x=0.5,y=0.05,size=14,fontface = \"bold\")\n```\n:::\n\n\n\nSave final Map.\n\n::: {.cell}\n\n```{.r .cell-code}\nragg::agg_png(here::here(\"R_general_resources/30DayMapChallenge/day18_water/water.png\"),\n              res = 320, width = 12, height = 8, units = \"in\")\nfinal\ndev.off()\n```\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}