{
  "hash": "cd21b2710cab0f67efd47bef606734f3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Micromapping'\nsubtitle: 'Welcome to #30DayMapChallenge 2024 Day 27'\ndate: '2024-11-27'\nimage: 'https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2024/day27_micromapping/day27_micromapping.png'\nimage-alt: 'day27_micromapping'\ndescription: 'Micromapping'\noutput: html_document\nexecute: \n   eval: false\n---\n\n![Micromapping](https://raw.githubusercontent.com/Fgazzelloni/30DayMapChallenge/master/2024/day27_micromapping/day27_micromapping.png)\n\n\nLoad Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(osmdata)\nlibrary(showtext)\n```\n:::\n\n\nSet the View Point: Rome - Colosseum \n\nCoordinates\n41.8902째 N, 12.4922째 E\n\n::: {.cell}\n\n```{.r .cell-code}\nlong = 12.4922\nlat = 41.8902\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwindow <- st_point(c(long, lat)) %>%\n  st_sfc(crs = 4326) %>%\n  st_sf() %>%\n  st_buffer(dist = 1000) %>%\n  st_bbox()\n\nwindow\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nosmdata::available_features()\n```\n:::\n\n\nDownload the Buildings / Features Data for the Area of Interest:\n\n::: {.cell}\n\n```{.r .cell-code}\nbuilding <- opq(window) %>%\n  add_osm_feature(key = \"building\") %>%\n  osmdata_sf()\n\nlanes <- opq(window) %>%\n  add_osm_feature(key = \"lanes\") %>%\n  osmdata_sf()\n\nhistoric <- opq(window) %>%\n  add_osm_feature(key = \"historic\") %>%\n  osmdata_sf()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbuilding_polygons <- building$osm_polygons\nlanes_linestrings <- lanes$osm_lines\nhistoric_polygons <- historic$osm_multipolygons\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbuilding_polygons%>%\n  count(building, sort = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlanes_linestrings%>%\n  count(lanes, sort = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhistoric_polygons%>%\n  count(historic, sort = TRUE)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(historic_polygons)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npolygons_mod <- building_polygons %>%\n  mutate(building = ifelse(!is.na(building), 'Buildings', \"Other\")) \n```\n:::\n\n\n\nSet the fonts:\n\n::: {.cell}\n\n```{.r .cell-code}\nfont_add_google(name = 'Caveat', family = 'Caveat')\nshowtext_auto()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Micromap focusing on a small neighborhood\nggplot() +\n  geom_sf(data = lanes_linestrings, \n          color = \"gray\") +\n  geom_sf(data = polygons_mod, \n          aes(fill = building), \n          linejoin = \"round\",\n          show.legend = F,\n          color = NA,\n          alpha = 0.6) +\n  geom_sf(data = historic_polygons, \n          color = \"darkred\",\n          linewidth = 0.1,\n          linetype = \"dashed\",\n          fill = NA,\n          alpha = 0.6) +\n  scale_fill_manual(values = c('navy','grey30')) +\n  coord_sf() +\n  labs(title = \"Micromap of Buildings and Roads\",\n       subtitle = \"Rome - Historical Site\\n41.8902째 N, 12.4922째 E\",\n       caption = \"Data: OpenStreetMap\\n#30DayMapChallenge Day27 | @fgazzelloni\",\n       x = \"Longitude\", y = \"Latitude\") +\n  ggthemes::theme_map() +\n  theme(text = element_text(family = 'Caveat', lineheight = 0.3),\n        plot.title = element_text(color = 'navy', \n                                  size = 80,\n                                  hjust = 0.5),\n        plot.subtitle = element_text(color = 'gray30', \n                                     size = 55,\n                                     hjust = 0.5),\n        plot.caption = element_text(color = 'gray30',\n                                    size = 50,\n                                    hjust = 0),\n        plot.background = element_rect(fill = 'grey90', \n                                       color = NA))\n```\n:::\n\n\n\n\nSave the map as png:\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave('day27_micromapping.png', \n       height = 8, width = 6, \n       dpi = 300)\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}