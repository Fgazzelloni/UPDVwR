{
  "hash": "b935b63e2751c5a09fd17e980e271f11",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Tiles'\nsubtitle: 'Welcome to #30DayChartChallenge 2022 day 23'\ndate: '2022-04-23'\nimage: 'day23_tiles.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n### Source: \n\n- https://ourworldindata.org/financing-education\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nedu_exp <- read_csv(\"total-government-expenditure-on-education-gdp.csv\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  edu_exp1 <- edu_exp%>%\n  janitor::clean_names()%>%\n  rename(value=government_expenditure_on_education_total_percent_of_gdp)\n\nedu_exp2 <- complete(edu_exp1, entity,year,fill=list(value=0))\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworld<- map_data(\"world\")\nregions<- plyr::count(world$region)%>%select(-freq)%>%unlist()\n\nedu_exp3 <- edu_exp2%>%\n  filter(entity%in%regions)\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_countries <- edu_exp3%>%\n  filter(!entity==\"Zimbabwe\")%>%\n  mutate(year2=cut(year,4))%>%\n  group_by(entity)%>%\n  summarize(tot=sum(value))%>%\n  ungroup()%>%\n  arrange(-tot)%>%\n  slice(1:50)%>%\n  unlist()\n\n\nedu_exp4 <- edu_exp3%>%\n  filter(entity%in%my_countries)%>%\n  mutate(entity=as.factor(entity),\n         year2=cut(year,4))%>%\n  group_by(entity,year2)%>%  #2500\n  mutate(value2=(value-mean(value))/(sd(value)/sqrt(2500)))%>%\n  ungroup()\n\n\nedu_exp4%>%summary\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\nlibrary(hrbrthemes)\nlibrary(extrafont)\n# loadfonts()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nedu_exp4%>%count(entity)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\np <- ggplot(edu_exp4, aes(x=year, y=fct_reorder(entity,value))) +\n  geom_tile(aes(fill = value),color=\"black\") +\n  geom_vline(aes(xintercept=c(1969.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(1979.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(1989.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(1999.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(2009.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  geom_vline(aes(xintercept=c(2019.5)),linetype=\"dashed\",size=1,alpha=0.2)+\n  scale_fill_gradient(low=\"white\",high=\"blue\",\n                      breaks=c(1.5,12),\n                      labels=c(\"Min\",\"Max\")) +\n  guides(fill = guide_colourbar(barwidth = 9, \n                                barheight = 2,title.position = \"top\",\n                                label = F,\n                                ticks = FALSE))+\n  scale_x_continuous(expand=c(0,0),\n                     breaks=seq(1970,2019,10),\n                     label=c(\"1970-1979\",\"1980-1989\",\"1990-1999\",\"2000-2009\",\"2010-2019\"))+\n  labs(title = \"Government expenditure on education\", subtitle=\"Selected countries with on average total (% of GDP) between 3 and 9%\",\n       caption=\"#30DayChartChallenge 2022 #Day23 -Tiles\n       DataSource: UNESCO Institute for Statistics via OurWorldInData\\n \n       DataViz: Federica Gazzelloni\",\n       x=\"\",y=\"\",fill=\"AVG tot GDP %\")+\n    theme_ipsum()+\n  theme(text=element_text(size=12,face=\"bold\",\n                          family=\"Roboto Condensed\"),\n        axis.text.x = element_text(size=16,vjust=0.5,hjust=-0.5),\n        axis.text.y = element_text(size=15),\n        plot.title = element_text(size=42,\n                                  family=\"Roboto Condensed\"),\n        plot.subtitle = element_text(family=\"Roboto Condensed\",size=18,face=\"bold\"),\n        plot.caption = element_text(family=\"Roboto Condensed\",size=15,hjust=1,face=\"bold\"),\n        plot.title.position = \"panel\",\n        plot.background = element_rect(color=\"grey80\",fill=\"grey80\"),\n        panel.background = element_rect(color=\"grey80\",fill=\"grey80\"),\n        legend.title = element_text(size=18,vjust=1,color=\"grey30\"),\n        legend.text = element_text(size=18,color=\"grey30\"),\n        legend.position = c(0,-0.09),\n        legend.direction = \"horizontal\",\n        plot.margin = margin(10,10,10,1,unit = \"pt\"))+\n  annotate(\"text\",x=1975,y=-4,label=\"How to read it:\\n- white means 0/empty-value\\n- color gradient range on avg between 3 and 9%\\n- avg calculated from 1970 to 2019\",hjust = 0)+\n  coord_cartesian(ylim=c(1,50),clip=\"off\")\n\np\n#ggplotly(p)\nggsave(\"day23_tiles.png\",\n       dpi=320,\n       width = 12,\n       height = 14)\n```\n:::\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}