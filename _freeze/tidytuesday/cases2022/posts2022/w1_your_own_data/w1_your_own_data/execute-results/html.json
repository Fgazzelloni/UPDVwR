{
  "hash": "358e02216d1bc3dc98572dfa9d5eee35",
  "result": {
    "markdown": "---\ntitle: 'Bring your own data from 2022!'\nsubtitle: 'Welcome to TidyTuesday 2022 week 1'\ndate: '2022-01-04'\nimage: \"w1_your_own_data.png\"\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\n\n\n## OMICRON INCREASE FROM 1 December 2021 TO 7 January 2022\n### DataSources:\n### https://www.ecdc.europa.eu/en/publications-data/data-virus-variants-covid-19-eueea\n#### https://www.gisaid.org/hcov19-variants/\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readr)\neu_data <- read_csv(\"/Users/federica/Documents/R/GBD/Comunicable_diseases/Covid19/variants/data.csv\")\neu_data2 <- read_csv(\"/Users/federica/Documents/R/GBD/Comunicable_diseases/Covid19/variants/data2.csv\")\n\n\neu_data%>%\n  select(country,variant)%>%\n  filter(str_detect(variant,\"B.1.1.\"))%>% #variant B.1.1.529\n  count(variant)\n\n\ncountrySubmissionCount <- read_csv(\"/Users/federica/Documents/R/GBD/Comunicable_diseases/Covid19/variants/countrySubmissionCount.csv\")\ncountrySubmissionCount2 <- read_csv(\"/Users/federica/Documents/R/GBD/Comunicable_diseases/Covid19/variants/countrySubmissionCount2.csv\")\n\n# map data\nlibrary(sf)\nworld <- rnaturalearth::ne_countries(scale=110,returnclass = \"sf\")\nworld<-filter(world,!continent==\"Antarctica\")\n\n\n# December 2021 data\nnew_data<- countrySubmissionCount%>%\n  mutate(variant=\"B.1.1.529\")%>%\n  rename(percent_variant=\"%GR/484A (B.1.1.529) in past 4 weeks\",\n         number_detections_variant=\"Total #GR/484A (B.1.1.529)\")%>%\n  mutate(year_week=\"2021-46\")%>%\n  janitor::clean_names()%>%\n  select(country,variant,percent_variant,year_week,number_detections_variant)\n\nfull_data <- eu_data%>%#count(country)%>%View()\n  full_join(new_data,by=c(\"country\",\"variant\",\"percent_variant\",\"year_week\",\"number_detections_variant\"))%>%\n  filter(str_detect(variant,\"B.1.1.5\"))%>%\n  filter(number_detections_variant>0)\n\nfull_data_geo<- full_data%>%\n  inner_join(world,by=c(\"country\"=\"name\"))\n\n# January 2022 data\nnew_data2<- countrySubmissionCount2%>%\n  mutate(variant=\"B.1.1.529\")%>%\n  rename(percent_variant=\"%Omicron GRA (B.1.1.529+BA.*) in past 4 weeks\",\n         number_detections_variant= \"Total #Omicron GRA (B.1.1.529+BA.*)\")%>%\n  mutate(percent_variant=gsub(\"%\",\"\",percent_variant),\n         percent_variant=as.double(percent_variant))%>%\n  mutate(year_week=\"2022-01\")%>%\n  janitor::clean_names()%>%\n  select(country,variant,percent_variant,year_week,number_detections_variant)\n\nfull_data2 <- eu_data2%>%#names()\n  select(country,year_week,new_cases,variant,percent_variant,number_detections_variant)%>%\n  full_join(new_data2,by=c(\"country\",\"variant\",\"percent_variant\",\"year_week\",\"number_detections_variant\"))%>%\n  filter(str_detect(variant,\"B.1.1.5\"))%>%\n  filter(number_detections_variant>0)\n\nfull_data_geo2<- full_data2%>%\n  inner_join(world,by=c(\"country\"=\"name\"))\n\n\n\ndec<-new_data%>%group_by(country)%>%summarise(median_dec=median(percent_variant))\n\njan<-new_data2%>%group_by(country)%>%summarise(median_jan=median(percent_variant))\n\nmerged<-dec%>%\n  merge(jan,by=\"country\")\n\ncountries<-merged%>%count(country)%>%select(-n)\n\n# libraries for fonts\nlibrary(ggCyberPunk)\nggCyberPunk::import_aldrich()\n\nlibrary(extrafont)\nlibrary(showtext)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=110)\nlibrary(sysfonts)\nsysfonts::font_families_google()\nfont_add_google(name =\"Texturina\" ,family = \"my_font\")\nfont_add_google(name =\"Suravaram\" ,family = \"my_font2\")\n\nfamily<-\"my_font\"\nfamily2<-\"my_font2\"\n\nlibrary(ggh4x)\nbarplot<-merged%>%\n  pivot_longer(cols = 2:3,names_to=\"names\",values_to=\"values\")%>%\n  ggplot()+\n  geom_col(aes(x=fct_reorder(country,-values),values,fill=names),\n           width = 0.5)+\n  scale_fill_cyberpunk(palette= \"laser sword\",reverse=F,\n                       labels=c(\"December\",\"January\"),\n                       name=\"\")+\n  scale_x_discrete(expand = expansion(mult = c(0,0)))+\n  # from: https://cran.r-project.org/web/packages/ggh4x/vignettes/PositionGuides.html\n  guides(y = guide_axis_manual( label_size = c(12, 9),label_hjust=1))+\n  coord_flip()+\n  theme_void()+\n  theme(text = element_text(family=family,size=14,color = \"#FFE1FF\"),\n        axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.text.y = element_text(family=family2,\n                                   size=8,color = \"#FFE1FF\",hjust = 0),\n        panel.grid = element_blank(),\n        plot.background = element_blank(),\n        panel.background = element_blank(),\n        legend.position = c(0.7,0.5),\n        legend.key.size = unit(0.5, 'cm'), #change legend key size\n        legend.key.height = unit(0.5, 'cm'), #change legend key height\n        legend.key.width = unit(0.5, 'cm'), #change legend key width\n        legend.text = element_text(size=10))\n\n\n\nplot <- ggplot(world)+\n  geom_sf(aes(geometry=geometry),fill=\"white\",size=0.01)+\n  geom_sf(data=full_data_geo,\n          mapping=aes(geometry=geometry,\n                      fill=percent_variant,\n                      color=percent_variant),\n          size=0.01)+\n  scale_fill_cyberpunk(palette = \"laser sword\",\n                       reverse=F,discrete=F,\n                       name=\"Percent Variant\",\n                       labels=c(\"<10%\",\"20%\",\"40%\",\"60%\"))+\n  coord_sf()+\n  labs(title=\"How fast is the New OMICRON variant spreading in the World?\")+\n  guides(color=\"none\")+\n  ggthemes::theme_map()+\n  theme(text = element_text(family=family,size=14,color = \"#FFE1FF\"),\n        plot.title = element_text(vjust=-1.5,size=12),\n        plot.title.position = \"panel\", \n        plot.caption = element_text(vjust=8),\n        legend.background = element_blank(),\n        legend.position = \"none\")\n\n\nplot2 <- ggplot(world)+\n  geom_sf(aes(geometry=geometry),fill=\"white\",size=0.01)+\n  geom_sf(data=full_data_geo2,\n          mapping=aes(geometry=geometry,\n          color=percent_variant,fill=percent_variant),size=0.1)+ \n  scale_fill_cyberpunk(palette= \"laser sword\",\n                       discrete = F,reverse = F,\n                       labels=c(\">0\",\"25%\",\"50%\",\"75%\",\"100%\"),\n                       name=\"\")+\n  coord_sf()+\n  guides(color=\"none\")+\n  ggthemes::theme_map()+\n  theme(text = element_text(family=family,size=14,color=\"#FFE1FF\"),\n        legend.direction = \"horizontal\",\n        legend.background = element_blank(),\n        legend.position =c(-0.35,0.5),\n        legend.justification = \"center\",\n        legend.text.align = 0.5,\n        legend.title = element_text(face = \"bold\",size=14),\n        legend.key.size = unit(0.5, 'cm'), #change legend key size\n        legend.key.height = unit(0.5, 'cm'), #change legend key height\n        legend.key.width = unit(0.5, 'cm'), #change legend key width\n        legend.text = element_text(size=10))\n\n\n\nlibrary(cowplot)\n\nfile<-\"data/2022/w1_your_own_data/your_own_data.png\"\nragg::agg_png(file,\n              res = 320, \n              width = 1200, \n              height = 675, \n              units = \"px\",\n              background = \"#5e3e4e\",#\"#4287f5\",\n              scaling = 0.5)\n\nggdraw()+\n  draw_label(\"Omicron genome sequences with unprecedented speed - one month of infection\",\n             x=0.5,y=0.97,fontfamily = family,size=20,\n             color=\"#eb3471\")+\n  draw_label(\"Omicron genome sequences with unprecedented speed - one month of infection\",\n             x=0.5,y=0.975,fontfamily = family,size=21,\n             color=\"#FFE1FF\")+\n  draw_plot(plot,x=0.18,y=0.2,scale=0.65)+\n  draw_plot(plot2,x=0.18,y=-0.25,scale=0.65)+\n  draw_label(\"Percent Variant (median values)\",\n             x=0.15,y=0.88,fontfamily = family,size=12,\n             color=\"#FFE1FF\")+\n  draw_plot(barplot,x=-0.28,y=0.15,scale=0.4)+\n  draw_label(\"Datasource: ECDC & GISAID | Map: Federica Gazzelloni\",\n             x=0.5,y=0.025,fontfamily = family,size=11.5,\n             color=\"#FFE1FF\")+\n  draw_label(\"Date: December 1st 2021\",x=0.98,y=0.73,size=10,angle=-90,\n             color=\"#FFE1FF\",fontfamily = family)+\n  draw_label(\"Date: January 7th 2022\",x=0.98,y=0.3,size=10,angle=-90,\n             color=\"#FFE1FF\",fontfamily = family)+\n  draw_label(\"Percent Variant\",x=0.15,y=0.33,size=12,color=\"#FFE1FF\",fontfamily = family)+\n  draw_label(\"Percent Variant values are calculated\\nconsidering the increase in\\nCovid19 new cases due\\nto the Omicron variant\",\n             x=0.15,y=0.1,size=10,color=\"#FFE1FF\",fontfamily = family) +\n  draw_image(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/static/plot_logo.png\",x=0.25,y=-0.45,scale=0.09)+\n  draw_image(\"data/2022/w1_your_own_data/omicron.png\",x=0.35,y=-0.45,scale=0.09)\n\ninvisible(dev.off())\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}