{
  "hash": "aeaaad3d99c29aa95e270c46cb1a032b",
  "result": {
    "markdown": "---\ntitle: 'US Drought'\nsubtitle: 'Welcome to TidyTuesday 2022 week 24'\ndate: '2022-06-14'\nimage: \"w24_drought.png\"\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n\n\n\n\n\n## Drought HEX\n\n\n::: {.cell paged.print='false'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(geojsonio)\nlibrary(RColorBrewer)\nlibrary(rgdal)\nlibrary(rgeos)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set the fonts\nlibrary(showtext)\nlibrary(sysfonts)\nlibrary(extrafont)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\nfont_add_google(name=\"Chelsea Market\",\n                family=\"Chelsea Market\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#tuesdata <- tidytuesdayR::tt_load('2022-06-14')\ndrought_fips <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-06-14/drought-fips.csv')\n```\n:::\n\n\n### Verify the avg level of drought for each state\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndrought_fips%>%\n  group_by(State)%>%\n  summarise(drought=mean(DSCI))%>%\n  ungroup() %>%\n  ggplot(aes(x=fct_reorder(State,-drought),y=drought))+\n  geom_col()+\n  labs(x=\"\",y=\"\",\n       title=\"Avg level of drought for each state\")+\n  ggthemes::theme_economist_white()+\n  theme(axis.text.x = element_text(size=5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndrought_avg<- drought_fips%>%\n  group_by(State)%>%\n  summarise(drought=mean(DSCI))%>%\n  ungroup()\n```\n:::\n\n\n### Load the map hex data and make extra features\n\nsource: https://d3-graph-gallery.com/graph/hexbinmap_geo_basic.html\n\n::: {.cell}\n\n```{.r .cell-code}\n# load json data\nmap_hex <- \n  geojson_read(\"us_states_hexgrid.geojson.json\",  what = \"sp\")\n\n# map_hex%>%class # SpatialPolygonsDataFrame\n# set the names\nmap_hex@data <-\n  map_hex@data %>%\n  mutate(google_name = gsub(\" \\\\(United States\\\\)\", \"\", google_name))\n\n\n# make a smaller sized hex \nmap_hex_buffer <- gBuffer(map_hex, width = -.15, byid = T)\n\n# tidy to dataframe\nmap_hex_tidy <- tidy(map_hex_buffer, region = \"iso3166_2\")\n\n# add drought level\nhex_drought <- \n  map_hex_tidy %>%\n  left_join(drought_avg, by = c(\"id\"=\"State\"))\n\n# make the centroids with state names\ncentr <- cbind.data.frame(data.frame(gCentroid(map_hex_buffer, byid = T), \n                                     id = map_hex@data$iso3166_2))\n```\n:::\n\n\n### Make the map hex with avg drought level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot()+\ngeom_polygon(data=map_hex,\nmapping=aes(long,lat,group=group),\nfill=\"brown\",\ncolor=\"#f8bc05\")+\ngeom_polygon(data=hex_drought,\nmapping=aes(long,lat,group=group,fill=drought),\ncolor=\"white\")+\ngeom_text(data=centr,\naes(x=x, y=y, label=id),\ncolor=\"white\",size=2,fontface=\"bold\") +\nscale_fill_gradient(low = \"grey\", high = \"brown\")+\nlabs(title=\"US intense drought locations\",\ncaption=\"DataSource: #TidyTuesday 2022 week24 & Drought.gov | DataViz: @FGazzelloni\",\nfill=\"Level\")+\ncoord_map()+\nggthemes::theme_map()+\ntheme(text=element_text(color=\"white\",family=\"Chelsea Market\"),\npanel.background = element_rect(fill=\"#162e51\",color=\"#f8bc05\",size=1),\nplot.background = element_rect(fill=\"#0071bc\",color=\"#f8bc05\",size=1),\nplot.title = element_text(size=20,color=\"#f8bc05\"),\nlegend.background = element_rect(fill=\"#0071bc\",color=\"#f8bc05\",size=0.5),\nlegend.position = c(0.01,0.3))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"w24_drought.png\",\ndpi=320,\nwidth = 5.9,\nheight = 4)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}