{
  "hash": "88373960e1fbb816439d3b7c54b8e4ee",
  "result": {
    "markdown": "---\ntitle: 'Indoor Air Pollution'\nsubtitle: 'Welcome to TidyTuesday 2022 week 15'\ndate: '2022-04-12'\nimage: \"w15_indoor_air_pollution.png\"\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list=ls())\nsetwd(dirname(rstudioapi::getActiveDocumentContext()$path))\n\n# load libraries and options\noptions(scipen = 999) # this is to avoid number truncation\nlibrary(countrycode)\nlibrary(tidyverse)\n\n# set the colors\nmycolors <- colorRampPalette(RColorBrewer::brewer.pal(n=9, name=\"Set1\"))(5)\n\n# load data\ndeath_timeseries<-read.csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-04-12/death_timeseries.csv\")\n\n# data wrangling\ndeath_timeseries1<-death_timeseries%>%\n  rename(Deaths=`Deaths...Cause..All.causes...Risk..Household.air.pollution.from.solid.fuels...Sex..Both...Age..All.Ages..Number.`,\n         Deaths1=`Deaths...Cause..All.causes...Risk..Household.air.pollution.from.solid.fuels...Sex..Both...Age..All.Ages..Number..1`)\n\n\ndeath_timeseries2 <- death_timeseries1%>%\n  filter(Year==1990,Year.1==2019) %>%\n  filter(!str_detect(Entity,\"World|Region|Central|Countries|European\"),\n         !str_detect(Entity,\"Western|Southern|Eastern|Northen\"),\n         !str_detect(Entity,\"North|South|Southeast\"),\n         !str_detect(Entity,\"income|High|Low\"),\n         !str_detect(Entity,\"Commonwealth\"),\n         !str_detect(Entity,\"G20|SDI\"),\n         !str_detect(Entity,\"Europe|Asia|Africa|America|Oceania\")\n         ) \n\n# add missing continents' names with countrycode() function -----------\ndeath_timeseries2$continent <- countrycode(sourcevar = death_timeseries2[, \"Entity\"],\n                                           origin = \"country.name\",\n                                           destination = \"continent\")\n\n\ndeath_timeseries3 <- death_timeseries2%>%\n  # check for some values that were not matched unambiguously ---------\n  # filter(Entity%in%c(\"Australasia\", \"Caribbean\", \n  #                    \"England\", \"Micronesia (country)\", \n  #                    \"Scotland\", \"Timor\", \"Wales\")) %>%\n  mutate(Entity=as.character(Entity), # mutate Entity back as a character to use case_when() function\n         continent=case_when(Entity%in%c(\"England\",\"Scotland\",\"Wales\")~\"Europe\", \n                          Entity==\"Australasia\"~\"Oceania\", \n                          Entity==\"Caribbean\"~\"Americas\", \n                          Entity==\"Micronesia (country)\"~\"Asia\", \n                          Entity==\"Timor\"~\"Asia\",\n                          TRUE ~ continent),\n         Entity=as.factor(Entity)) %>%\n  filter(Deaths1>=1,Deaths>=1) \n\n# make the plot\ndeath_timeseries3 %>%\n  ggplot(aes(x=Deaths1,y=Deaths))+\n  geom_jitter(size=1.7,aes(fill=continent),shape=21,alpha=0.7,color=\"grey45\")+\n  geom_smooth(method = \"lm\",se=F,color=\"grey60\",\n              linetype=\"dashed\",size=0.5)+\n  geom_text(aes(label=Entity,color=continent),\n            hjust = \"left\",\n            show.legend = F,\n            vjust=\"top\",\n            check_overlap = T,\n            size=3)+\n  scale_x_log10(breaks=c(1,10,100,1000,10000,100000),\n                expand=expansion(add=c(0,0.05)),\n                label=scales::comma_format(accuracy = NULL))+\n  scale_y_log10(breaks=c(1,10,100,1000,10000,100000),\n                expand=expansion(add=c(0,0.8)),\n                label=scales::comma_format(accuracy = NULL))+ \n  scale_fill_manual(guide=guide_legend(nrow = 1),\n                    values=mycolors)+\n  scale_color_manual(values=mycolors)+\n  labs(title=\"Deaths due to Household air pollution\\nfrom solid fuels\",\n       subtitle=\"1990 vs 2019 All Ages and Gender\",\n       caption=\"\\n#30DayChartChallenge 2022 day12 - theme day: The Economist\\nDataSource: Our World in Data | #TidyTuesday week15 - Indoor Air Pollution\\nDataViz: Federica Gazzelloni\",\n       x=\"Deaths from indoor air pollution in 2019\",\n       y=\"Deaths from indoor air pollution in 1990\",fill=\"\") +\n  ggthemes::theme_economist() +\n  theme(legend.text = element_text(size=10),\n        plot.title = element_text(size=23),\n        axis.title.x = element_text(vjust = -0.8),\n        axis.title.y = element_text(vjust = 0.8),\n        plot.caption = element_text(vjust = -1,size=9),\n        legend.position = c(0.4,0.85))\n\n#save the plot\nggsave(\"day12_the_economist.png\",\n       dpi=320,\n       width = 8,\n       height = 6)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}