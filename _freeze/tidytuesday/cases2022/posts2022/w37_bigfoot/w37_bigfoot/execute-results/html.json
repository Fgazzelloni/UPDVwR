{
  "hash": "eafa39a3f2f4cfe4a308b6445f282925",
  "result": {
    "markdown": "---\ntitle: 'Bigfoot'\nsubtitle: 'Welcome to TidyTuesday 2022 week 37'\ndate: '2022-09-13'\nimage: \"w37_bigfoot.png\"\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(\"~/Documents/R/R_general_resources/TidyTuesday/data/2022/w37_bigfoot\")\nlibrary(tidyverse)\n# bigfoot colors: https://icolorpalette.com/color/bigfoot\n\n# load data\nbigfoot <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-09-13/bigfoot.csv')\ndf <- bigfoot%>%\n  select(county,\n         state,\n         latitude,\n         longitude,\n         date,\n         number,\n         precip_type,\n         visibility,\n         classification) %>%\n  filter(!is.na(latitude)) %>%\n  mutate(precip_type=ifelse(is.na(precip_type),\"unknown\",precip_type),\n         date=as.Date(date,\"%Y-%m-%d\")) %>%\n  mutate(year=lubridate::year(date),.after=\"date\",\n         visibility=ifelse(is.na(visibility),mean(visibility,na.rm = T),visibility)) %>%\n  filter(year>=1963) %>%\n  filter(longitude>-130) %>%\n  mutate(state=tolower(state),\n         classification=case_when(classification==\"Class A\"~\"clear sightings\",\n                                  classification==\"Class B\"~\"not clear view\",\n                                  classification==\"Class C\"~\"second-hand reports\")) %>%\n  rename(ID=state)\ndf%>%names\n\n\n\nlabels <- df%>%\n  group_by(ID) %>%\n  mutate(pct_view=number/sum(number)*100,.after=number)%>%\n  mutate(cent_long=mean(range(longitude)),cent_lat=mean(range(latitude)),.after=longitude)%>%\n  ungroup() %>%\n  count(ID,cent_long,cent_lat,pct_view)%>%\n  group_by(ID) %>%\n  summarize(avg_pct_view=round(mean(pct_view),2),cent_long,cent_lat,.groups=\"drop\")%>%\n  ungroup() %>%\n  distinct()\n\nlabels\n\n\nstates <- map_data(\"state\")\nworld <- map_data(\"world\") %>%\n  # set a restricted view to long = c(-122,-66) and lat = c(25,50)\n  filter(long> -125,long< -66,\n         lat> 25, lat< 60)\n\n# load BigFoot fonts\n# library(systemfonts)\n# fonts <- system_fonts()\n# fonts%>%\n#  arrange(family)%>%\n#  filter(str_detect(family,\"Big\"))%>%select(family)\n\n\nlibrary(randomcoloR)\nn <- 48\npalette <- distinctColorPalette(n)\n\nset.seed(1)\np <- ggplot() +\n  geom_polygon(data = world, mapping = aes(long, lat,\n                                           group=group),\n               fill=\"#f4d6b5\",color=\"#446471\",\n               size=0.2) +\n  geom_polygon(data = states, mapping = aes(long, lat,\n                                            group=group),\n               fill=\"#ebe2df\",color=\"#446471\",\n               size=0.2) +\n  geom_point(df, mapping = aes(x=longitude,y=latitude,\n                               color=ID),\n             alpha=0.3,\n             size=0.5,show.legend = F) +\n  ggrepel::geom_label_repel(labels, \n            mapping = aes(x=cent_long,y=cent_lat,\n                          label=avg_pct_view),\n            label.padding = unit(0.05,\"pt\"),\n            color=\"#1a2f38\",\n            family=\"Monaco\",\n            size=3,\n            max.overlaps = Inf,\n            label.size = unit(0.05,\"pt\"), \n            fill = \"grey90\"\n            )+\n  coord_map() +\n  scale_color_manual(values = palette) +\n  ggthemes::theme_map() +\n  labs(title=\"Bigfoot\",\n       subtitle = \"Avg(%) views by county from 1963\",\n       color=\"\",\n       caption=\"\\nDataSource: #TidyTuesday2022 week37 BigFoot\\nDataViz: Federica Gazzelloni\\n\") +\n  theme_void()+\n  theme(text=element_text(family=\"Monaco\",color=\"grey30\"),\n        plot.title = element_text(size=55,hjust=0.1,vjust=0.5,\n                                  family=\"Big Bloke BB\"),\n        plot.subtitle = element_text(size=9,hjust=0.1),\n        plot.caption = element_text(vjust = 0.5,hjust=0),\n        plot.title.position = \"plot\",\n        legend.key.size = unit(1,units = \"pt\"),\n        legend.background = element_rect(fill=\"white\"),\n        legend.key = element_blank(),\n        legend.box.background = element_blank(),\n        legend.direction = \"horizontal\",\n        legend.position = c(0.3,0.05),\n        plot.background = element_rect(fill=\"#fff0c6\",\n                                       color=\"#fff0c6\"))\n  \nlibrary(cowplot)\nggdraw(p)+\n  draw_image(\"bigfoot.png\",scale=0.2,\n             y=0.144,x=-0.15) +\n  draw_image(\"bigfoot.png\",scale=0.15,\n             y=0.12,x=0)+\n  draw_image(\"bigfoot.png\",scale=0.1,\n             y=0.08,x=0.1)\n\n\n\nggsave(\"w37_bigfoot.png\",\n       bg=\"#fff0c6\",\n       dpi=320,\n       width = 5.81,\n       height = 6)\n\ndev.off()\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}