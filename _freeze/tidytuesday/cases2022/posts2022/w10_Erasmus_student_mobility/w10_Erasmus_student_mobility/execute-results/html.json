{
  "hash": "ca05ab5d54011708ac2978098a714e72",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Erasmus student mobility'\nsubtitle: 'Welcome to #TidyTuesday 2022 day 10'\ndate: '2022-03-08'\nimage: 'https://raw.githubusercontent.com/Fgazzelloni/TidyTuesday/main/data/2022/w10_erasmus/er-network.png'\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggbump)\nlibrary(showtext)\nlibrary(sysfonts)\nlibrary(extrafont)\n\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\n\nfont_add_google(name=\"Noto Sans\",family=\"notosans\")\n\n\nlibrary(ggthemes)\n\n\nerasmus <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-03-08/erasmus.csv')\n\ndf <- erasmus %>%\n  group_by(academic_year) %>%\n  filter(between(x = participant_age,17,28),\n         mobility_duration>3) %>%\n  summarise(m_participants=mean(participants),\n            sending_country_code,receiving_country_code,\n            .groups=\"drop\") %>%\n  ungroup() %>%\n  distinct()%>%\n  filter(sending_country_code %in% c(\"DE\",\"ES\",\"IT\",\"RO\",\"UK\")) %>%\n  mutate(sending_country_name=case_when(sending_country_code==\"DE\" ~ \"Germany\",\n                                        sending_country_code==\"ES\" ~ \"Spain\",\n                                        sending_country_code==\"IT\" ~ \"Italy\",\n                                        sending_country_code==\"RO\" ~ \"Romania\",\n                                        TRUE~\"UK\")) %>%\n  mutate(year_id=case_when(academic_year==\"2014-2015\"~1,\n                           academic_year==\"2015-2016\"~2,\n                           academic_year==\"2016-2017\"~3,\n                           academic_year==\"2017-2018\"~4,\n                           academic_year==\"2018-2019\"~5,\n                           academic_year==\"2019-2020\"~6))%>%\n  count(year_id,academic_year,sending_country_name) %>%\n  group_by(academic_year)%>%\n  mutate(rank=rank(x=n,ties.method = \"random\"))%>%\n  ungroup()\n\n\n\ndf %>%\nggplot(mapping=aes(academic_year,rank,\n                   group=factor(sending_country_name),\n                   color=factor(sending_country_name))) +\n  geom_point(size = 7) +\n  geom_text(data = df %>% filter(year_id == min(year_id)),\n            aes(x = year_id - .1, label = sending_country_name), \n            size = 4, hjust = 1) +\n  geom_text(data = df %>% filter(year_id == max(year_id)),\n            aes(x = year_id + .1, label = sending_country_name), \n            size = 4, hjust = 0,check_overlap = T) +\n  geom_bump(size = 2, smooth = 8) +\n  labs(y = \"RANK\",\n       x = \"Academic Year\",\n       title=\"Erasmus Top 5 student exchange countries\",\n       subtitle=\"Ranks of the highest sending frequency\",\n       caption=\"DataSource: Erasmus student mobility | Data.Europa.eu | Wimdu.co\\nDataViz: Federica Gazzelloni | #TidyTuesday Week 10 Erasmus\") +\n  scale_y_reverse() +\n  scale_color_manual(values = wesanderson::wes_palette(5, name = \"Royal2\"))+\n  cowplot::theme_minimal_grid(font_size = 14, line_size = 0) +\n  theme(legend.position = \"none\",\n        panel.grid.major = element_blank(),\n        plot.title = element_text(color=\"#ffc7ba\"),\n        plot.subtitle = element_text(color=\"#ffc7ba\"),\n        plot.caption = element_text(color=\"#ffc7ba\",size=8),\n        axis.text = element_text(color=\"#ffc7ba\"),\n        axis.title = element_text(color=\"#ffc7ba\"),\n        plot.background = element_rect(color=\"black\",fill=\"black\"),\n        panel.background = element_rect(color=\"black\",fill=\"black\"))\n \n\nggsave(\"er-network_a.png\",height =6,width = 10 )  \n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}