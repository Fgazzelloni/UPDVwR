{
  "hash": "d777b32bd4f4137da6f4a18337dd2385",
  "result": {
    "markdown": "---\ntitle: 'Horror Movies'\nsubtitle: 'Welcome to TidyTuesday 2022 week 44'\ndate: '2022-11-01'\nimage: \"w44_horror_movies.png\"\nimage-alt: ''\ndescription: 'Networks'\noutput: html_document\nexecute: \n   eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhorror_movies <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-01/horror_movies.csv')\nhorror_movies%>%head\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhorror_movies%>%names\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhorror_movies%>%DataExplorer::profile_missing()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Library\nlibrary(tidyverse)\nlibrary(streamgraph)\n\n# set the fonts\nlibrary(showtext)\nlibrary(sysfonts)\nlibrary(extrafont)\nshowtext::showtext_auto()\nshowtext::showtext_opts(dpi=320)\nfont_add_google(name=\"Creepster\",family=\"Creepster\")\n\n\nhorror_movies<-readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-01/horror_movies.csv')\n\nhorror_movies%>%\n  pull(revenue)%>%summary()\nhorror_movies%>%\nfilter(revenue==701842551)%>%View\n\n# Create data:\nhorror_movies%>%\n  arrange(release_date) %>%\n  filter(str_detect(genre_names,\"horror|Horror\"),\n         status==\"Released\",\n         revenue> 0) %>%\n  select(id,title,original_language,\n         release_date,\n         genre_names,\n         popularity,vote_average,\n         budget,revenue) %>% \n  mutate(title=trimws(title),\n         ymonth=zoo::as.yearmon(release_date),\n         year=lubridate::year(release_date)) %>%\n  group_by(original_language,year) %>%\n  summarize(avg_budget=round(mean(budget),2),\n            avg_revenue=round(mean(revenue),2))%>%\n  ungroup() %>%\n  arrange(-avg_budget,-avg_revenue) %>%\n  mutate(name=original_language,\n         value=avg_revenue) -> data\n\n\n\n\n# remotes::install_github(\"davidsjoberg/ggstream\")\nlibrary(ggstream)\n\nlabel<-data %>%\n  group_by(original_language)%>%\n  summarize(year=round(mean(year)),\n            value=max(value))%>%\n  ungroup()\n\ndata %>% #pull(value)%>%summary()\n  ggplot(\n    aes(\n      year, value, \n      color = original_language, \n      fill = original_language\n    )\n  ) +\n  geom_stream(\n    geom = \"polygon\",\n    bw = .45,\n    size = 0,\n    show.legend = F\n  ) +\n  geom_stream(\n    geom = \"contour\",\n    color = \"grey20\",\n    size = 0.05,\n    bw = .45, # Controls smoothness\n    show.legend = F\n  ) +\n  scale_y_log10()+\n  geom_text(data=label,\n            aes(x=year,value,\n                label=original_language),\n            family=\"Creepster\",\n            show.legend = FALSE,\n            check_overlap = FALSE)+\n  labs(title=\"Horror Movies\",\n       subtitle=\"revenue by original language\",\n       caption=\"Your fears are unleashed - IT (2017) reached the highest revenue with $701 842 551\\nDataSource: #TidyTuesday 2022 week 44: Horror Movies by The Movie Database\\nDataViz: Federica Gazzelloni (@fgazzelloni)\",\n       x=\"Year\",y=\"Revenue\") +\n  theme_minimal()+\n  theme(text=element_text(color=\"white\",\n                          family=\"Creepster\"),\n        plot.title = element_text(size=25),\n        axis.text.x = element_text(color=\"grey80\"),\n        plot.background = element_rect(color=\"grey5\",fill=\"grey5\"))\n\n# 7.53 x 6.03\nggsave(\"w44_horror_movies.png\",\n       dpi=300,\n       width = 7.53,\n       height = 6.03)\n# geom_stream_label(aes(label = original_language),)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}