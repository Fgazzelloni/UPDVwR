{
  "hash": "159d4ad7cbbb809e60b448453515ef2e",
  "result": {
    "markdown": "---\ntitle: \"Dubois Challenge\"\nsubtitle: \"Welcome to TidyTuesday 2021 week 25\"\ndate: \"2021-06-15\"\nimage: \"w25_du_bois.png\"\nimage-alt: \"\"\ndescription: \"Networks\"\noutput: html_document\nexecute: \n  eval: false\n---\n\n\n\n# Week 25 \n\nDataSource:\nhttps://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-06-15/readme.md\n\nDubois Style\nhttps://github.com/ajstarks/dubois-data-portraits/blob/master/dubois-style.pdf\n\nAdd fonts\nhttps://cran.rstudio.com/web/packages/showtext/vignettes/introduction.html\nhttps://fonts.google.com/specimen/Shadows+Into+Light#standard-styles\n\n\ninspirations\nhttps://github.com/ivoruaro/tidytuesday/blob/main/2021w25.R\nhttps://github.com/nrennie/tidytuesday/blob/main/2021/15-06-2021/15062021.R\nhttps://gist.github.com/clauswilke/783e1a8ee3233775c9c3b8bfe531e28a\n\n\nimage background\nhttps://www.pngwing.com/en/free-png-zfvci\n\n\n# load libraries \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidytuesdayR)\nlibrary(tidyverse)\nlibrary(DataExplorer)\nlibrary(ggtext)\nlibrary(DataEditR)\nlibrary(tidyquant)\n\n\nlibrary(RColorBrewer)\n\nlibrary(maps)\nlibrary(rnaturalearth)\nlibrary(sp)\nlibrary(sf)\n\nlibrary(extrafont)\n#library(ggrepel)\n\n#library(viridis)\nlibrary(hrbrthemes)\n\nlibrary(ggimage)\nlibrary(patchwork)\nlibrary(cowplot)\n\nlibrary(ggpattern)\n\n\n# add font -------------------------------------------------\nlibrary(showtext)\nfont_add_google(\"Shadows Into Light\",\"shadow_into_light\")\nfont_add_google(\"Schoolbell\", \"bell\")\nshowtext_auto(enable = TRUE)\n\n# load data ----------------------------------------\ntuesdata <- tidytuesdayR::tt_load('2021-06-15')\n\ntweets <- tuesdata$tweets\n\n# check data -----------------------\nhead(tweets)\n\nprofile_missing(tweets)\n\n# tidying -----------------------------------\ndf_tweets<-tweets%>%\n  arrange(-like_count,-followers)%>%\n  drop_na()\n\nplyr::count(df_tweets$location)\n\n# load map data ------------------------------\n\n# world data full \nworld_full <- ne_countries(scale = \"medium\", returnclass = \"sf\")\nworld_data <- filter(world_full, continent != \"Antarctica\")\n\n# world lat&long\nworld<-map_data(map = \"world\") \n\nmy_world_data<- world%>%\n  full_join(world_data, by = c(\"region\"=\"name\"))%>%\n  select(long,lat,group,order,region,region_wb)\n\n# states lat&long\nstates <- map_data(\"state\")\n\n# choose palette colors ----------------------\n# dubois palette taken from Dubois Style webpage\ndubois_pal <- c(\"black\" = \"#000000\", \n                \"brown\" = \"#654321\", \n                \"tan\" = \"#d2b48c\",\n                \"gold\" = \"#ffd700\",\n                \"pink\"=\"#ffc0cb\",\n                \"red\"=\"#dc143c\",\n                \"green\"=\"#00aa00\",\n                \"blue\"=\"#4682b4\")\n\npalette<-c(\"#000000\",\"#654321\",\"#d2b48c\",\"#ffd700\",\"#ffc0cb\",\"#dc143c\",\"#00aa00\",\"#4682b4\")\n\nstates_palette<-colorRampPalette(c(\"#654321\",\"#d2b48c\",\"#ffd700\",\"#ffc0cb\",\"#dc143c\",\"#00aa00\",\"#4682b4\"))(15537)\n\npal_west <- c(\"#000000\", \"#4682b4\")\npal_est <- c(\"#000000\", \"#4682b4\")\n\npal_fill<-c(\"background\"=\"#e8d8c3\",\n            \"water\"=\"#d9c09e\",\n            \"europe\"=\"#ffd700\",\n            \"canada\"=\"#654921\",\n            \"southAmerica\"=\"#1b1209\")\n\n\n# make the plot ---------------------\n\nworld_west <-ggplot() +\n  geom_polygon(data=my_world_data,aes(x=long,y=lat,group=group,fill=region_wb)) + scale_fill_manual(values=palette) + guides(fill=FALSE)+\n  \n  geom_polygon(data = states,aes(x = long, y = lat, group = group),fill=states_palette,color=\"#000000\",size=0.3)+#scale_fill_manual(values=states_palette) +guides(fill=FALSE)+\n  \n  geom_path(data=world,aes(x=long,y=lat,group=group),size=0.3) +\n  \n  geom_point(data = df_tweets,mapping=aes(x=long, y=lat, size=followers, shape=verified,color=verified),alpha=0.7) +\n  \n  geom_path(data = df_tweets,mapping=aes(x=long, y=lat,group=location),size=0.3,color=\"#654321\") + \n  \n  coord_map(\"ortho\", orientation = c(3.849945, -103.525750, 0)) + \n  \n  #geom_text(data = df_tweets,aes(x=long, y=lat, group=location, label=location), check_overlap = TRUE,color=\"#654321\",size = 3, hjust=0.5, vjust=-1)+\n  \n  #geom_curve(data = df_tweets,aes(x=long, y=lat, group=location, label=location))+\n  \n # annotate(\"text\", x = 0, y = 0,family= \"shadow_into_light\",label=\"World map of \",color = \"#ffc0cb\", size = 4,fontface=\"bold\") +\n  \n  scale_size(guide=FALSE, range = c(1,9)) +\n  scale_shape(guide=FALSE) +\n  scale_color_manual(values = pal_west, aesthetics = c(\"colour\")) +\n  labs(x=\"\",y=\"\",color=\"Verified accounts\") +\n  theme_void() +\n  theme(plot.background = element_rect(fill = \"#e8d8c3\", colour = \"#e8d8c3\"),#   element_rect(color=\"#e8d8c3\",fill=\"#e8d8c3\"),\n        panel.background = element_rect(color=\"#e8d8c3\",fill=\"#d9c09e\"),\n        axis.line = element_blank(),\n        axis.text.x = element_blank(),\n        panel.grid = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"bottom\",\n        legend.text = element_text(family=\"shadow_into_light\"),\n        legend.title = element_text(family=\"shadow_into_light\"))\n\n# world_west\n\n\n\nworld_est <-ggplot() +\n  geom_polygon(data=my_world_data,aes(x=long,y=lat,group=group,fill=region_wb)) + scale_fill_manual(values=palette) + guides(fill=FALSE)+\n  \n  geom_polygon(data = states,aes(x = long, y = lat, group = group),fill=states_palette,color=\"#000000\",size=0.3)+#scale_fill_manual(values=states_palette) +guides(fill=FALSE)+\n  \n  geom_path(data=world,aes(x=long,y=lat,group=group),size=0.3) +\n  \n  geom_point(data = df_tweets,mapping=aes(x=long, y=lat, size=followers, shape=verified,color=verified),alpha=0.7) +\n  \n  geom_path(data = df_tweets,mapping=aes(x=long, y=lat,group=location),size=0.3,color=\"#654321\") + \n  \n  coord_map(\"ortho\", orientation = c(19.982182, 46.595135, 0)) +\n  \n  #geom_text(data = df_tweets,aes(x=long, y=lat, group=location, label=location), check_overlap = TRUE,color=\"#654321\",size = 3, hjust=0, vjust=-1)+\n  \n  #geom_curve(data = df_tweets,aes(x=long, y=lat, group=location, label=location))+\n  \n  #annotate(\"text\", x = 0, y = 0,family= \"shadow_into_light\",label=\"Tweets sized by followers\",color = \"#ffc0cb\", size = 4,fontface=\"bold\") +\n \n  scale_size(guide=FALSE, range = c(1,9)) +\n  scale_shape(guide=FALSE)+\n  scale_color_manual(values = pal_est,aesthetics = c(\"colour\"))+ #, \"fill\")) +\n  labs(caption=\"Viz @fgazzelloni DataSource: WEB Du Bois and Juneteenth\t#DuBoisChallenge tweets\tThe Intercept #TidyTuesday 2021/25\",\n       x=\"\",y=\"\",color=\"\") +\n  theme_void() +\n  theme(plot.background = element_rect(fill = \"#e8d8c3\", colour = \"#e8d8c3\"),\n        panel.background = element_rect(color=\"#e8d8c3\",fill=\"#d9c09e\"),\n        plot.caption = element_text(color=\"#00aa00\",face=\"bold\",family=\"shadow_into_light\"),\n        axis.line = element_blank(),\n        axis.text.x = element_blank(),\n        panel.grid = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"none\")\n\n# world_est\n\n\nmain_plot <- (world_west + world_est)\n\nplot <-plot_grid(main_plot)\n\nfinal <- plot +\n  theme(plot.background = element_rect(fill = \"#e8d8c3\", colour = \"#e8d8c3\"),\n        plot.margin = margin(t=0,r=1,b=0,l=1,unit=\"pt\"))\n\n\ntitle<- ggplot()+\n  labs(title=\"\\n\\n#DuBoisChalllenge 2021 Twitter Metrics\",\n       subtitle=\"Tweets by number of followers (verified or not) and by selected locations\\n\\nINSPIRED BY:\\n\",\n       tag=\"\\nTHE GEORGIA NEGRO \\nA SOCIAL STUDY \\nby W.E. BURGHARDT\\n\\n\") +\n  theme_void()+\n  theme(plot.background = element_rect(fill = \"#e8d8c3\", colour = \"#e8d8c3\"),# element_rect(color=\"#e8d8c3\",fill=\"#e8d8c3\"),\n        panel.background = element_rect(color=\"#e8d8c3\",fill=\"#e8d8c3\"),\n        plot.title = element_text(color=\"#000000\",size=20,face=\"bold\",family=\"bell\",hjust = 0.5,vjust = 0),\n        plot.subtitle = element_text(color=\"#000000\",size=12,face=\"bold\",family=\"bell\",vjust = 0,hjust = 0.5),\n        plot.tag = element_text(color=\"#000000\",size=12,face=\"bold\"),\n        plot.tag.position = \"bottom\",\n        plot.margin = margin(t=0,r=1,b=1,l=1,unit=\"pt\"))\n\ncaption<- ggplot()+\n  labs(title=\"ROUTES OF THE TWEETS BY LOCATIONS\",\n       subtitle=\"THIS CASE IS DEVOTED TO A SERIES OF CHARTS, MAPS AND OTHER DEVICES DESIGNED TO ILLUSTRATE \\nTHE DEVELOPMENT OF THE AMERICA NEGRO IN A SIGLE TYPICAL STATE OF THE UNITED STATES\",\n       tag=\"THE PROBLEM OF THE 20^th CENTURY IS THE PROBLEM OF THE COLOR-LINE\\n\") +\n  theme_void()+\n  theme(plot.background = element_rect(fill = \"#e8d8c3\", colour = \"#e8d8c3\"),# element_rect(color=\"#e8d8c3\",fill=\"#e8d8c3\"),\n        panel.background = element_rect(color=\"#e8d8c3\",fill=\"#e8d8c3\"),\n        plot.title = element_text(color=\"#000000\",size=11,face=\"bold\",family=\"bell\",hjust=0.5),\n        plot.subtitle = element_text(color=\"#000000\",size=10,face=\"bold\",family=\"bell\",vjust = -1,hjust = 0.5),\n        plot.tag = element_text(color=\"#000000\",size=8,face=\"bold\"),\n        plot.tag.position = \"bottom\",\n        plot.margin = margin(t=0,r=1,b=0,l=1,unit=\"pt\"))\n  \n\n        \nfinal_plot<-plot_grid(title,final,caption,ncol=1,rel_heights = c(0.4,1,0.15))\n\n\n\n\n###################### SAVING ############################\n\n\nragg::agg_png(here::here(\"w25\",\"w25_tweets.png\"),\n              res = 320, width = 14, height = 8, units = \"in\")\nfinal_plot\n\ndev.off()\n\n\n\n#### ATTACHING LOGO ############################\nlibrary(ggimage)\nlibrary(magick)\n\n\ntidy_logo<-image_read(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/static/plot_logo.png\") %>%\n  image_resize(\"300x300\")\n\n\nfinal_plot <- image_read(\"w25/w25_tweets.png\")\n\nattached_logo <- image_composite(final_plot, tidy_logo,\n                                 operator=\"atop\",\n                                 gravity=\"northeast\") # tell R where to put the logo\n\n\nimage_write(attached_logo, path = \"w25/w25_tweets.png\",\n            format = \"png\") # save final plot\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}