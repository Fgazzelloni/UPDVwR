{
  "hash": "fc487d742cb9a27633285c4801c49211",
  "result": {
    "markdown": "---\ntitle: \"FORMULA1\"\nsubtitle: \"Welcome to TidyTuesday 2021 week 37\"\ndate: \"2021-09-07\"\nimage: \"w37_formula1.png\"\nimage-alt: \"\"\ndescription: \"Networks\"\noutput: html_document\nexecute: \n  eval: false\n---\n\n\n\n# TidyTuesday Week37 - FORMULA1\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ntuesdata <- tidytuesdayR::tt_load(2021, week = 37)\n\nresults <- tuesdata$results\nqualifying <- tuesdata$qualifying\nconstructors <- tuesdata$constructors\ndrivers <- tuesdata$drivers\n\n\nmy_df <- qualifying%>%\n  left_join(results%>%select(raceId,driverId,constructorId,points), by=c(\"raceId\",\"driverId\",\"constructorId\")) %>%\n  left_join(constructors,by=\"constructorId\") %>%\n  left_join(drivers%>%select(driverId,forename,surname),by=\"driverId\") %>%\n  count(qualifyId,raceId,driverId,forename,surname,constructorId,name,number,position,points,sort=T) %>%\n  unite(\"driver_name\",forename:surname,sep=\" \",remove=TRUE) %>%\n  count(driverId,driver_name,constructorId,name,number,position,points)%>%\n  arrange(position,-number,-points) %>%\n  filter(position<=10)\n\n\nrank_df<- my_df%>%\n  group_by(name,position)%>%\n  summarize(total=sum(points),.groups=\"drop\")%>%\n  ungroup()%>%\n  arrange(position) %>%\n  pivot_wider(values_from = total,names_from=position)\n\nrank_df[is.na(rank_df)]<-0\n\n\n# rank_df <- column_to_rownames(rank_df,var = \"driver_name\")\n\nrank_df\n\n#library(ggbump)\nlibrary(ggrepel)\nlibrary(extrafont)\n#fonts()\n\nrank_df_long <- rank_df %>%arrange(-`1`)%>% slice(1:10)%>%\n  pivot_longer(cols = 2:11,names_to=\"position\",values_to=\"points\")%>%\n  mutate(position=as.numeric(position),\n         position=factor(position))\n\nsummary_first_position <- rank_df_long%>%filter(name==c(\"Mercedes\",\"Red Bull\",\"Ferrari\"))%>%filter(position==1)%>%summary()\n\nlibrary(hrbrthemes)\nlibrary(GGally)\nlibrary(viridis)\n\ncolors <- c(\"#0EED4D\", \"#008B00\", \"#17B6EB\",\n            \"#C00000\" , \"#FF8700\", \"#00D2BE\",\n            \"#0600EF\", \"#FFF500\", \"#E68C17\", \"#0082FA\")\n\ncolors2 <- c(\"grey70\", \"grey70\", \"grey70\",\n            \"#C00000\" , \"#FF8700\", \"#00D2BE\",\n            \"#0600EF\", \"grey70\", \"grey70\", \"grey70\")\n\n\nplot <- rank_df_long%>%\n  ggplot(aes(x=fct_reorder(position,-position),y=points,group=name,color=factor(name)))+\n  geom_point(aes(size=points),shape = 21, fill = \"white\",  stroke = 5)+\n  geom_line(size=2)+\n  scale_color_manual(values = colors2)+\n  labs(y=\"Points\",x=\"Positions\",\n       color=\"Top 10 Constructors\",size=\"Points\")+\n  theme_gray()+\n  theme(text = element_text(family=\"Impact\",color=\"grey90\"),\n        plot.margin = margin(1,1,1,1,unit = \"pt\"),\n        panel.grid.major.y = element_line(size=2),\n        panel.background = element_rect(color=\"grey20\",fill=\"grey20\"),\n        plot.background = element_rect(color=\"grey20\",fill=\"grey20\"),\n        legend.key = element_blank(),\n        legend.background = element_blank(),\n        legend.text = element_text(color=\"grey90\",size=14),\n        legend.title = element_text(color=\"grey90\",size=14),\n        axis.text = element_text(color=\"grey90\"),\n        axis.title = element_text(size=14),\n        panel.grid.major.x = element_blank(),\n        panel.grid.minor.y = element_blank()\n  )\n\n\nlibrary(ggpubr)\ngraphics <- ggarrange(plot)+\n  theme(plot.background = element_rect(fill=\"#228B22\", color = NA))\n\nfinal_plot <- annotate_figure(graphics,\n                              top = text_grob(\"FORMULA 1 WINNER CONSTRUCTORS\",\n                                              color = c(\"red\"), face = \"bold\", size = 45,\n                                              family = \"Impact\"),\n                              bottom = text_grob(\"Infographics Federica Gazzelloni DataSource: Ergast API, TidyTuesday week37\",\n                                                 color = \"black\",family = \"Impact\",\n                                                 hjust = 0.5, x = 0.5, face = \"bold.italic\", size = 20),\n                              left = text_grob(\"FORMULA 1\", color = c(\"#778899\"), rot = 90,size = 30),\n                              right = text_grob(bquote(\"FORMULA1\"), color = c(\"#778899\"),rot = 90,size = 30),\n                              fig.lab = \"TidyTuesday week37\", fig.lab.face = \"bold.italic\",fig.lab.size = 12,\n                              fig.lab.pos = \"bottom.right\"\n)\n\n\n\nfinal_plot <-\n  final_plot +\n\n  annotate(geom = \"text\", label = \"Lewis Hamilton\\nNico Rosberg\\n Valtteri Bottas \\n- Mercedes\",\n           x = 0.11, y = 0.85,colour = \"#00D2BE\",size = 4,family = \"Impact\") +\n  annotate(geom = \"curve\", x = 0.07, xend = 0.09, y = 0.85, yend = 0.76, colour = \"#00D2BE\", curvature = .3, arrow = arrow(length = unit(2, \"mm\")),family = \"Impact\",size=1.5) +\n\n  annotate(geom = \"text\", label = \"Sebastian Vettel\\nMark Webber\\nMax Verstappen - Red Bull\",\n           x = 0.23, y = 0.49,colour = \"#0600EF\",size = 4.5,family = \"Impact\") +\n  annotate(geom = \"curve\", x = 0.25, xend = 0.28, y = 0.53, yend = 0.69, colour = \"#0600EF\", curvature = -.3, arrow = arrow(length = unit(2, \"mm\")),family = \"Impact\",size=1.5) +\n\n  annotate(geom = \"text\", label = \"Charles Leclerc\\nFernando Alonso\\n - Ferrari\",\n           x = 0.1, y = 0.63,colour = \"#C00000\",size = 4,family = \"Impact\") +\n  annotate(geom = \"curve\", x = 0.09, xend = 0.10, y = 0.67, yend = 0.70, colour = \"#C00000\", curvature = -.3, arrow = arrow(length = unit(2, \"mm\")),family = \"Impact\",size=1.5) +\n\n  annotate(geom = \"text\", label = \"F1\",x = 0.85, y = 0.88, colour = \"red\", size = 5,family = \"Impact\") +\n\n  annotate(geom = \"text\", label = \"MERCEDES, RED BULL and FERRARI\\n reached the higest level of points\\n at being number one\\nwith an average of 418.8 points\",x = 0.7, y = 0.81, colour = \"white\", size = 7,family = \"Impact\")+\n\n\n  annotate(geom = \"text\", label = \"Lewis Hamilton - McLaren\",x = 0.7, y = 0.53, colour = \"#FF8700\", size = 5,family = \"Impact\") +\n  annotate(geom = \"curve\", x = 0.68, xend = 0.64, y = 0.52, yend = 0.41, colour = \"#FF7F00\", curvature = -.3, arrow = arrow(length = unit(2, \"mm\")),family = \"Impact\",size=1.5)\n\nlibrary(ggimage)\nlibrary(magick)\nlibrary(cowplot)\n\n\nlogo_f1_img <- image_read(here::here(\"w37/F1.svg.png\"))\n\n\nfinal <- ggdraw() +\n  draw_plot(final_plot) +\n  draw_image(logo_f1_img, x = 0.1, y = 0.47,width = 0.12)\n\n\n\n## Save final plot ----\n\nragg::agg_png(here::here(\"w37/formula1_second_version.png\"),\n              res = 320, width = 16, height = 8, units = \"in\")\nfinal\n\ndev.off()\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}